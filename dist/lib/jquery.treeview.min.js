(function(a){a.extend(a.fn,{swapClass:function(a,e){var l=this.filter("."+a);this.filter("."+e).removeClass(e).addClass(a);l.removeClass(a).addClass(e);return this},replaceClass:function(a,e){return this.filter("."+a).removeClass(a).addClass(e).end()},hoverClass:function(e){e=e||"hover";return this.hover(function(){a(this).addClass(e)},function(){a(this).removeClass(e)})},heightToggle:function(a,e){a?this.animate({height:"toggle"},a,e):this.each(function(){jQuery(this)[jQuery(this).is(":hidden")?"show":"hide"]();if(e)e.apply(this,arguments)})},heightHide:function(a,e){if(a){this.animate({height:"hide"},a,e)}else{this.hide();if(e)this.each(e)}},prepareBranches:function(a){if(!a.prerendered){this.filter(":last-child:not(ul)").addClass(e.last);this.filter((a.collapsed?"":"."+e.closed)+":not(."+e.open+")").find(">ul").hide()}return this.filter(":has(>ul)")},applyClasses:function(l,s){this.filter(":has(>ul):not(:has(>a))").find(">span").unbind("click.treeview").bind("click.treeview",function(e){if(this==e.target)s.apply(a(this).next())}).add(a("a",this)).hoverClass();if(!l.prerendered){this.filter(":has(>ul:hidden)").addClass(e.expandable).replaceClass(e.last,e.lastExpandable);this.not(":has(>ul:hidden)").addClass(e.collapsable).replaceClass(e.last,e.lastCollapsable);var t=this.find("div."+e.hitarea);if(!t.length)t=this.prepend('<div class="'+e.hitarea+'"/>').find("div."+e.hitarea);t.removeClass().addClass(e.hitarea).each(function(){var e="";a.each(a(this).parent().attr("class").split(" "),function(){e+=this+"-hitarea "});a(this).addClass(e)})}this.find("div."+e.hitarea).click(s)},treeview:function(l){l=a.extend({cookieId:"treeview"},l);if(l.toggle){var s=l.toggle;l.toggle=function(){return s.apply(a(this).parent()[0],arguments)}}function t(l,s){function t(s){return function(){i.apply(a("div."+e.hitarea,l).filter(function(){return s?a(this).parent("."+s).length:true}));return false}}a("a:eq(0)",s).click(t(e.collapsable));a("a:eq(1)",s).click(t(e.expandable));a("a:eq(2)",s).click(t())}function i(){a(this).parent().find(">.hitarea").swapClass(e.collapsableHitarea,e.expandableHitarea).swapClass(e.lastCollapsableHitarea,e.lastExpandableHitarea).end().swapClass(e.collapsable,e.expandable).swapClass(e.lastCollapsable,e.lastExpandable).find(">ul").heightToggle(l.animated,l.toggle);if(l.unique){a(this).parent().siblings().find(">.hitarea").replaceClass(e.collapsableHitarea,e.expandableHitarea).replaceClass(e.lastCollapsableHitarea,e.lastExpandableHitarea).end().replaceClass(e.collapsable,e.expandable).replaceClass(e.lastCollapsable,e.lastExpandable).find(">ul").heightHide(l.animated,l.toggle)}}this.data("toggler",i);function n(){function e(a){return a?1:0}var s=[];o.each(function(e,l){s[e]=a(l).is(":has(>ul:visible)")?1:0});a.cookie(l.cookieId,s.join(""),l.cookieOptions)}function r(){var e=a.cookie(l.cookieId);if(e){var s=e.split("");o.each(function(e,l){a(l).find(">ul")[parseInt(s[e])?"show":"hide"]()})}}this.addClass("treeview");var o=this.find("li").prepareBranches(l);switch(l.persist){case"cookie":var d=l.toggle;l.toggle=function(){n();if(d){d.apply(this,arguments)}};r();break;case"location":var h=this.find("a").filter(function(){return location.href.toLowerCase().indexOf(this.href.toLowerCase())==0});if(h.length){var p=h.addClass("selected").parents("ul, li").add(h.next()).show();if(l.prerendered){p.filter("li").swapClass(e.collapsable,e.expandable).swapClass(e.lastCollapsable,e.lastExpandable).find(">.hitarea").swapClass(e.collapsableHitarea,e.expandableHitarea).swapClass(e.lastCollapsableHitarea,e.lastExpandableHitarea)}}break}o.applyClasses(l,i);if(l.control){t(this,l.control);a(l.control).show()}return this}});a.treeview={};var e=a.treeview.classes={open:"open",closed:"closed",expandable:"expandable",expandableHitarea:"expandable-hitarea",lastExpandableHitarea:"lastExpandable-hitarea",collapsable:"collapsable",collapsableHitarea:"collapsable-hitarea",lastCollapsableHitarea:"lastCollapsable-hitarea",lastCollapsable:"lastCollapsable",lastExpandable:"lastExpandable",last:"last",hitarea:"hitarea"}})(jQuery);