// داشبورد مدیریتی صدف info@sadafdashboard.ir

var ngApp=angular.module("navbarCat",["pascalprecht.translate","ngSanitize"]);ngApp.factory("navbar",["$rootScope",function(a){var b=null;return{getOption:function(){return b},setOption:function(c){b=c,a.$broadcast("navbarChange")}}}]),ngApp.factory("drawer",[function(a){var b={init:function(){if(!$("body #drawer-overlay").length){var a='<div class="drawer-overlay" id="drawer-overlay"></div>';$("body").append(a),$("body #drawer-overlay").on("click",this.close)}},toggle:function(){$("body").hasClass("drawer-open")?$("body").removeClass("drawer-open"):$("body").addClass("drawer-open")},close:function(){$("body").removeClass("drawer-open")}};return{init:b.init,toggle:b.toggle,close:b.close}}]),ngApp.controller("navbarCtrl",["$scope","$http","$rootScope","navbar","drawer","$translate",function(a,b,c,d,e,f){a.toggle=function(){e.toggle()},f.use(0==+$("#lang").val()?"fa":"en"),b.get(app.urlPrefix+"menu/MainMenu").then(function(b){a.menu=b.data,a.dashboardActions={fullScreenToggle:function(){},designToggle:function(){},printToggle:function(){},slideShowToggle:function(){},canDesign:!0},d.getOption()&&(a.dashboardActions=d.getOption()),c.$on("navbarChange",function(){d.getOption()&&(a.dashboardActions=d.getOption())})}),app.lang.setLang({selector:".navbar.navbar-inverse"})}]),angular.module("uibCollapseCat",[]).directive("uibCollapse",["$animate","$q","$parse","$injector",function(a,b,c,d){var e=d.has("$animateCss")?d.get("$animateCss"):null;return{link:function(d,f,g){function h(){f.hasClass("collapse")&&f.hasClass("in")||b.resolve(l(d)).then(function(){f.removeClass("collapse").addClass("collapsing").attr("aria-expanded",!0).attr("aria-hidden",!1),e?e(f,{addClass:"in",easing:"ease",to:{height:f[0].scrollHeight+"px"}}).start()["finally"](i):a.addClass(f,"in",{to:{height:f[0].scrollHeight+"px"}}).then(i)})}function i(){f.removeClass("collapsing").addClass("collapse").css({height:"auto"}),m(d)}function j(){return f.hasClass("collapse")||f.hasClass("in")?void b.resolve(n(d)).then(function(){f.css({height:f[0].scrollHeight+"px"}).removeClass("collapse").addClass("collapsing").attr("aria-expanded",!1).attr("aria-hidden",!0),e?e(f,{removeClass:"in",to:{height:"0"}}).start()["finally"](k):a.removeClass(f,"in",{to:{height:"0"}}).then(k)}):k()}function k(){f.css({height:"0"}),f.removeClass("collapsing").addClass("collapse"),o(d)}var l=c(g.expanding),m=c(g.expanded),n=c(g.collapsing),o=c(g.collapsed);d.$eval(g.uibCollapse)||f.addClass("in").addClass("collapse").attr("aria-expanded",!0).attr("aria-hidden",!1).css({height:"auto"}),d.$watch(g.uibCollapse,function(a){a?j():h()})}}}]);var ngApp=angular.module("sadaf",["ngRoute","filterBox","navbarCat","ui.sortable","pascalprecht.translate","ngSanitize","uibCollapseCat"]);ngApp.config(["$translateProvider",function(a){console.log("### $translateProvider "+app.urlPrefix+" "),a.useStaticFilesLoader({prefix:app.urlPrefix+"dist/locales/locale-",suffix:".js"}),a.preferredLanguage("fa"),a.useSanitizeValueStrategy("sanitizeParameters")}]);var service=["$http","$interval",function(a,b){var c;return{start:function(){var d=function(){console.log("### heartBeat "+Date()),a.get(app.urlPrefix+"api/onlineusers/heartbeat").then(null,function(a){a&&a.data&&a.data.forceSignout&&(alert("شما از برنامه خارج شده‌اید. ممکن است کاربر دیگری با نام کاربری شما وارد سیستم شده باشد."),window.location.href=app.urlPrefix)})};d(),c=b(d,3e4)},stop:function(){b.cancel(c)}}}];try{var sadaf=angular.module("sadaf");sadaf.factory("heartBeat",service),sadaf.run(["heartBeat",function(a){a.start()}])}catch(e){}try{var management=angular.module("management");management.factory("heartBeat",service),management.run(["heartBeat",function(a){a.start()}])}catch(e){}var app=app||{};app.contentSegment=$("#content_segment"),app.contentSegmentModal=$("#content_segmentModal"),console||(console={},console.log=function(){}),app.chartLoadDelay=120,app.absoluteUrl="/",app.setAboluteUrl=function(a){app.absoluteUrl=a},app.loadContent=function(a){app.showLoadingProgress(),$("#content_segment").load(app.urlPrefix+a,function(){app.hideLoadingProgress(),app.lang.setLang()})},app.setContent=function(a){$("#content_segment").html(a),app.hideLoadingProgress(),app.lang.setLang()},app.setLocation=function(a){app.router.navigate(a,{trigger:!0})},app.urlPrefix="/",app.setUrlPrefix=function(a){app.urlPrefix=a.replace(/Moderation.*/g,"")},app.showInfo=function(a){$("#app-info-text").html(a),$("#app-info-text").fadeIn(),$("#app-loading-text").hide(),app.showInfoHolder.show(),setTimeout(function(){app.showInfoHolder.hide(),$("#app-info-text").fadeOut(400,function(){$("#app-loading-text").show()})},4e3)},app.showLoadingProgress=function(){app.showInfoHolder.show()},app.hideLoadingProgress=function(){app.showInfoHolder.hide()},app.showInfoHolder={holderCount:0,timeout:{},hide:function(){if(app.showInfoHolder.holderCount>0&&--app.showInfoHolder.holderCount,0==app.showInfoHolder.holderCount){var a=(new Date).getTime()-app.showInfoHolder.ticks;clearTimeout(app.showInfoHolder.timeout),setTimeout(function(){$("#app-loading").parent("div").animate({top:"0",opacity:0},400)},1e3>a?1e3:0)}},show:function(){var a=$("#app-loading").parent("div");a.css("left",$(window).width()/2-a.outerWidth()/2),++app.showInfoHolder.holderCount,app.showInfoHolder.ticks=(new Date).getTime(),app.showInfoHolder.timeout=setTimeout(function(){$("#app-loading").parent("div").animate({top:"50",opacity:1},400)},1e3)}},app.encodeHTML=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;")},app.convertOldPropObject=function(a,b){if(a){if(a.chartProp&&a.chartProp.info)return a;var c={};if(c.chartProp={},+b==chartTypes.TABLE){c.chartProp.info={chartSize:a.chartProp.chartSize,pivotTable:a.chartProp.pivotTable},c.chartProp.series={};for(var d in a.seriesProp)a.seriesProp.hasOwnProperty(d)&&(c.chartProp.series[""+d]={name:a.seriesProp[""+d].table.headerName,numberFactor:"1",textAlign:a.seriesProp[""+d].table.textAlign,formatString:a.seriesProp[""+d].table.formatString,fontSize:a.seriesProp[""+d].table.fontSize,textBold:!1,textItalic:!1,color:a.seriesProp[""+d].table.fontColor}),c.chartProp.series["default"]={name:"",numberFactor:"1",textAlign:"right",formatString:"A",fontSize:"1m",textBold:!1,textItalic:!1,color:"#000000"}}if(+b==chartTypes.BAR){c.chartProp.info={chartSize:a.chartProp.chartSize,horizontalLines:a.chartProp.horizontalLine,formatString:a.chartProp.formatString},c.chartProp.series={};for(var d in a.seriesProp)a.seriesProp.hasOwnProperty(d)&&(c.chartProp.series[""+d]={name:"",numberFactor:a.seriesProp[""+d].barlineChartProp.numberFactor,seriesType:a.seriesProp[""+d].barlineChartProp.barlineChartType,seriesColor:a.seriesProp[""+d].barlineChartProp.barlineChartColor,lineType:a.seriesProp[""+d].barlineChartProp.barlineChartTypeLineProp.lineChartStyle,lineStyle:a.seriesProp[""+d].barlineChartProp.barlineChartTypeLineProp.lineChartLineStyle,lineWeight:a.seriesProp[""+d].barlineChartProp.barlineChartTypeLineProp.lineChartLineWeight,lineFace:a.seriesProp[""+d].barlineChartProp.barlineChartTypeLineProp.lineChartLineDashes});c.chartProp.series["default"]={name:"",numberFactor:"1",seriesType:"bar",seriesColor:"#1f77b4",lineType:"line-dot-area",lineStyle:"linear",lineWeight:"2",lineFace:"5,0"}}return+b==chartTypes.PIE&&(c.chartProp.info={horizontalLines:a.chartProp.horizontalLine,chartSize:a.chartProp.chartSize,formatString:a.chartProp.formatString,pieStyle:a.chartProp.pieStyle,hole:"65"},c.chartProp.series={},c.chartProp.series["default"]={numberFactor:"1"}),+b==chartTypes.GAUGE&&(c.chartProp.info={chartSize:a.chartProp.chartSize,style:a.chartProp.gaugeStyle,height:"medium",color:"#333333",fontSize:"3em",formatString:",.2f",status:"",target:"",textBold:!0,textItalic:!1,trend:"",value:"",segmentType:"singleSegment",min:"",yellow:"",green:"",max:""},c.chartProp.series={},c.chartProp.series["default"]={numberFactor:"1",type:"value",typeMs:"value"}),c.dataUrl=a.chartProp.DataUrl,c.editMode=a.chartProp.editMode,c}},app.autoPlayTimer=app.autoPlayTimer||{counter:0},app.autoPlay=function(a,b){if(a&&"start"==a){var c=$("#side-navigation2 .simple-link");b=b||10,$(".sadaf-circular-preogress").progressbar(10,1e3*+b),app.autoPlayTimer.timer=setTimeout(function(){var a=$(c[app.autoPlayTimer.counter++%c.length]);document.location.href=a.attr("href"),a.parents(".panel-collapse").collapse("show"),$(".sadaf-circular-preogress").progressbar("stop"),app.autoPlay("start",b)},1e3*+b)}a&&"stop"==a&&($(".sadaf-circular-preogress").progressbar("stop"),clearTimeout(app.autoPlayTimer.timer))};var resizeTimer;app.lestenWindowResize=function(a){function b(){clearTimeout(resizeTimer),resizeTimer=setTimeout(function(){a()},400)}var c=$(window).width();$(window).resize(function(){$(window).width();$(window).width()!=c&&(c=$(this).width(),b())})};var designMenuTimer,printMenuTimer;app.onMenusClick=function(a,b){return"showPrintMenu"==a||"hidePrintMenu"==a?(clearTimeout(printMenuTimer),void(printMenuTimer=setTimeout(function(){"showPrintMenu"==a?$(".navbar .print-toggle").fadeIn():"hidePrintMenu"==a&&$(".navbar .print-toggle").fadeOut()},800))):(clearTimeout(designMenuTimer),designMenuTimer=setTimeout(function(){"showDesignMenu"==a?$(".navbar .design-toggle").fadeIn():"hideDesignMenu"==a&&$(".navbar .design-toggle").fadeOut(),b&&"showfullScreenMenu"==b?$(".navbar .fullscreen-toggle").parents(".pull-right").fadeIn():$(".navbar .fullscreen-toggle").parents(".pull-right").fadeOut()},800),void $("html,body").animate({scrollTop:0},"slow",function(){$(".side-menu").hasClass("open")&&$("#side-menu-toggle").click()}))},app.print={printSingle:function(a,b){var c=this.getWidgetHtml(a);app.print.print(c,b)},getWidgetHtml:function(a){var b=$(a).height(),c=$(a).width(),d=$(a).clone();d.width(c),d.height(b);var e=d.find(".ui.dimmer .dimmer-info").html();d.find(".header").remove(),d.find(".ui.dimmer ").remove();var f=$("<div>").append(d).html(),g=$('<div style="margin-top:10px;">'+e+"</div>").width(c),h=$("<div>").html(f).append(g);h.css({"page-break-inside":"avoid",margin:"0 50px 50px 50px"}),h.addClass("pull-left");var i=$("<div>").append(h).html();return i},printPage:function(){var a="";$(".chart-widget").each(function(){var b=$(this).find(".chart-layout").attr("id");a+=app.print.getWidgetHtml("#"+b)});var b=$(".dashboard-page.active > a").text();app.print.print(a,b)},print:function(a,b){var c='<link href="'+app.absoluteUrl+'Content/custom-rtl.css" rel="stylesheet"  type="text/css"/>               <link href="'+app.absoluteUrl+'Areas/Charts/Content/barChart-rtl.css" rel="stylesheet"  type="text/css"/>               <link href="'+app.absoluteUrl+'Content/bootstrap-select.css" rel="stylesheet"  type="text/css"/>               <link href="'+app.absoluteUrl+'Content/bootstrap-rtl.css" rel="stylesheet"  type="text/css"/>               <link href="'+app.absoluteUrl+'Areas/Charts/Content/dashboardPage-rtl.css" rel="stylesheet"  type="text/css"/>               <style  type="text/css">@page {                            margin: 1.5cm;                            @top-center {                                    content: "sapam";                                }                            }                </style>',d=window.open();d.document.write('<html><head><meta charset="utf-8"><title>'+b+"</title>"+c),d.document.write("</head><body>"),d.document.write(a),d.document.write("</body></html>"),d.document.close(),d.focus(),setTimeout(function(){d.print()},400)}},app.post=function(a,b,c){$.ajax({url:a,type:"POST",data:JSON.stringify(b),dataType:"json",contentType:"application/json; charset=utf-8",traditional:!0,success:c})},app.lang={langType:0,setLangTyle:function(a){this.langType=+(a||0)},isRtl:function(){return 0==app.lang.langType},translate:function(a){return app.lang.lang?app.lang.lang[a]||a:a},q:[],translateAsync:function(a,b){app.lang.lang?b&&b(app.lang.lang[a]||a):this.q.push({key:a,callback:b})},setLang:function(a){if(a&&a.data&&(this.lang=a.data),this.lang||!this.inProgress){if(!this.lang&&!this.inProgress){var b=0==app.lang.langType?"fa":"en";this.inProgress=!0;var c=app.urlPrefix+"dist/locales/locale-"+b+".js?v="+app.version;return void $.getJSON(c,null,function(a){for(app.lang.setLang({data:a});app.lang.q.length>0;){var b=q.pop();b.callback&&callback(app.lang.lang[b.key]||b.key)}})}var d;d=a&&a.selector?$(a.selector).find("*[data-trans-key]"):$("*[data-trans-key]"),d.each(function(){var a=$(this),b=a.data("translated");if(!b){var c=app.lang.lang[a.data("trans-key")],d=a.data("trans-attr");d?a.attr(d,c):a.text(c),a.data("translated",!0)}})}}};var app=app||{};app.filterBox=angular.module("filterBox",["ngAnimate"]),app.filterBox.config(["$httpProvider",function(a){a.defaults.headers.get||(a.defaults.headers.get={}),a.defaults.headers.get["If-Modified-Since"]="Mon, 26 Jul 1997 05:00:00 GMT",a.defaults.headers.get["Cache-Control"]="no-cache",a.defaults.headers.get.Pragma="no-cache"}]),app.filterBox.controller("filterBoxController",["$scope","$http","$sce","$timeout","$rootScope",function(a,b,c,d,e){e.$on("app-filterbox-refresh",function(){a.refresh()}),a.refresh=function(){d(function(){a.otherFilters=[],_.forEach(app.chartCommons.drillDown.filters,function(b){_.forEach(b.drillDown,function(c){a.otherFilters.push({key:c.key,value:c.value,chartInPageId:b.chartInPageId,datasourceId:b.datasourceId})})}),a.userControlFilter=[],app.chartCommons.userFilter.filters.forEach(function(b){function d(a){switch(a){case"GetDate":return"امروز";case"MonthToDate":return"از ابتدای ماه تا امروز";case"YearToDate":return"از ابتدای سال تا امروز";case"DaysAgo":return persian(b.values[2]||0)+" روز قبل تا "+persian(b.values[3]||0)+" روز قبل";case"MonthAgo":return persian(b.values[2]||0)+" ماه قبل تا "+persian(b.values[3]||0)+" ماه قبل"}return""}var e={};e.key=b.dimensionName,e.chartInPageId=b.chartInPageId,e.values=_.map(b.values,function(a){return a&&isNaN(a)?a.replace(/\[(calc|index)-\d+\]/,""):a});var f=b.values.join(", ");if(f.length>30&&(f=f.substring(0,30)+"..."),e.Caption=c.trustAsHtml(f),3==+b.variableType)e.Caption=c.trustAsHtml(d(b.values[0]));else if(4==+b.variableType){var g={gr:"بزرگتر",eqgr:"بزرگتر مساوی",ls:"کوچکتر",eqls:"کوچکتر مساوی",eq:"برابر",nteq:"نابرابر"};e.Caption=c.trustAsHtml("<b>"+g[b.values[1]]+"</b> "+b.values[0])}else 5==+b.variableType&&(e.Caption=c.trustAsHtml("<b>"+b.values[0]+"</b>"+("or"==b.values[1]?" در یکی از ":" در همه ")+": "+b.values[2]));a.userControlFilter.push(e)})},0)},a.removeUserControl=function(b){var c=a.userControlFilter[b];a.userControlFilter.splice(b,1);var d=_.find(app.chartCommons.userFilter.filters,{chartInPageId:c.chartInPageId,dimensionName:c.key});_.isUndefined(d)||_.remove(app.chartCommons.userFilter.filters,d);var e=$("#ID"+c.chartInPageId).data("settings");app.moderation.dashboadpage.refreshRelatedDatasources(e.input.RefreshDatasource)},a.removeDrillDown=function(b){var c=a.otherFilters[b];a.otherFilters.splice(b,1);var d=_.find(app.chartCommons.drillDown.filters,{chartInPageId:c.chartInPageId});_.isUndefined(d)||_.remove(d.drillDown,{key:c.key});var e=$("#ID"+c.chartInPageId).data("settings");app.moderation.dashboadpage.refreshRelatedDatasources(e.input.RefreshDatasource)},a.clearAll=function(){var b=[];_.each(a.otherFilters,function(a){var c=$("#ID"+a.chartInPageId).data("settings");c&&c.input&&_.isArray(c.input.RefreshDatasource)&&(b=_.concat(b,c.input.RefreshDatasource))}),_.each(a.userControlFilter,function(a){var c=$("#ID"+a.chartInPageId).data("settings");_.isArray(c&&c.input&&c.input.RefreshDatasource)&&(b=_.concat(b,c.input.RefreshDatasource))}),app.chartCommons.drillDown.clearAll(),app.chartCommons.userFilter.filters=[],a.refresh(),app.moderation.dashboadpage.refreshRelatedDatasources(_.uniq(b))}}]),app.filterBox.refresh=function(){console.log("call refresh"),angular.element("#filter-box-controller").scope().refresh(),angular.element("#filter-box-controller").scope().$apply()},app.moderation=app.moderation||{},app.moderation.dashboadpage=app.moderation.dashboadpage||{},app.moderation.dashboadpage.globalFilterList=[],app.moderation.dashboadpage.syncWithGlobalFilter=function(a){if(null!=a)for(var b=0;b<a.length;b++){var c=$.grep(app.moderation.dashboadpage.globalFilterList,function(c){return c.Uniquename==a[b].Uniquename&&c.DataSourceId==a[b].DataSourceId&&c.CubeName==a[b].CubeName});0!=c.length&&(a[b].Members=c[0].Members.slice())}},app.moderation.dashboadpage.isRelated=!1,app.moderation.dashboadpage.onRelatedChange=function(a){app.moderation.dashboadpage.isRelated=a;for(var b=app.moderation.dashboadpage.charts,c=0;c<b.length;c++){var d=$("#ID"+b[c].pageId),e=d.data("settings");e.link="bold"}app.moderation.dashboadpage.isRelated?$(".glyphicon-link").show():$(".glyphicon-link").hide()},app.moderation.dashboadpage.showDimentions=function(){var a=$("#corelate-filter-list .filter-content").html();if(""==a.trim()){$(".glyphicon-link").addClass("link");for(var b=app.moderation.dashboadpage.charts,c=[],d=!0,e=0;e<b.length;e++){var f=$("#ID"+b[e].pageId),g=f.data("settings"),h=g.input.Dimentions;if(g.input.EditPermission)for(var i in h)for(var j=0;j<h[i].length;j++){var f={Uniquename:h[i][j],DataSourceId:g.input.DataSourceId,CubeName:g.input.CubeName,ChartId:g.chartId},k=$.grep(c,function(a){return a.Uniquename==f.Uniquename&&a.DataSourceId==f.DataSourceId&&a.CubeName==f.CubeName});0==k.length&&c.push(f)}else d=!1}var l=$("#corelate-filter-list .filter-content");l.html('<div style="padding:3px"><img style="width: 1.3em" src="'+app.urlPrefix+'Images/progress.gif" /><span  data-trans-key="در حال بارگذاری..."></span></div>'),0==c.length?($("#corelate-filter-list .filter-content").empty(),$("#corelate-filter-list .filter-content").html(d?"":"شما مجوز استفاده از این امکان را ندارید.")):$.ajax({type:"post",url:app.urlPrefix+"Charts/DashboardPage/GetHierarchies",data:JSON.stringify(c),contentType:"application/json; charset=utf-8"}).done(function(a){function b(a,b){if(null!=a)for(var c='<div class="container-fluid form-horizontal " style="margin-bottom:-15px;"><div class="form-group">',d=0,e=0,f=0;f<a.length;f++){var g=a[f];null!=g.Members&&(f>0&&(3==e||d!=g.DataSourceId)&&(c+='</div><div class="form-group">',e=0),d!=g.DataSourceId&&f>0&&(c+='<hr style="margin-top: 5px;;"/>'),e++,d=g.DataSourceId,c+='<div class="col-md-4">                                    <div class="btn btn-default col-md-12 filter-member-dialog" style="overflow: hidden; text-overflow: ellipsis;"                                            CubeName="'+g.CubeName+'" DataSourceId="'+g.DataSourceId+'" Uniquename="'+g.Uniquename+'"                                             title="'+g.Caption+'">'+g.Caption+"</div></div>")}return c+="</div></div>"}if($("#corelate-filter-list .filter-content").empty(),!a.result)return void $("#corelate-filter-list .filter-content").html(a.message);var c=b(a.data,"");l.html(c),l.find(".filter-member-dialog").on("click",function(){var b=$(this),c=$(this).attr("Uniquename"),d=$(this).attr("DataSourceId"),e=$(this).attr("CubeName"),f=$.grep(a.data,function(a,b){return a.Uniquename==c&&a.DataSourceId==d&&a.CubeName==e})[0];app.helper.filterMemberDialog(f.Members,function(a){f.Members=a;var c=a.filter(function(a){return a.IsChecked}).map(function(a){return a.Caption}),d=f.Caption;c.length>3?d="انتخاب "+c.length+" از "+a.length:c.length>0&&(d=c.join(" و ")),b.text(d),app.moderation.dashboadpage.getWheres(f,f.DataSourceId)})})})}},app.moderation.dashboadpage.getWheres=function(a,b){if("undefined"!=typeof b){$.grep(a.Members,function(a){return a.IsChecked})}if(app.moderation.dashboadpage.isRelated){for(var c=app.moderation.dashboadpage.globalFilterList,d=app.moderation.dashboadpage.charts,e=!1,f=0;f<c.length;f++){var g=c[f];g.Uniquename==a.Uniquename&&g.DataSourceId==a.DataSourceId&&g.CubeName==a.CubeName&&(c[f]=$.extend({},a),e=!0)}e||c.push($.extend({},a));for(var f=0;f<d.length;f++){var h=$("#ID"+d[f].pageId),i=h.data("settings");if(i.input.DataSourceId==a.DataSourceId&&i.input.CubeName==a.CubeName&&$("#ID"+d[f].pageId+" .glyphicon-link").hasClass("link")){var j=(-1!=$.inArray(a.Uniquename,i.input.Dimentions.Where),-1!=$.inArray(a.Uniquename,i.input.Dimentions.Hierarchies),-1!=$.inArray(a.Uniquename,i.input.Dimentions.SeriesLevel),h.find("#filter").data("data"));"undefined"!=typeof j&&(app.moderation.dashboadpage.syncWithGlobalFilter(j.Where),app.moderation.dashboadpage.syncWithGlobalFilter(j.Hierarchies),app.moderation.dashboadpage.syncWithGlobalFilter(j.SeriesLevel)),i.titlebar.showProgress(!0);var k=$.extend({},a);k.Members=$.grep(a.Members,function(a){return a.IsChecked}),i.parameters={ChartInPageId:i.ChartInPageId,Filter:[k]},h.charts(i.type,"refreshWithData",i)}}}},app.moderation.dashboadpage.refreshRelatedDatasources=function(a,b){var b=b||[],a=a||[];b=b.map(function(a){return+a});var c=0;$(".bar-chart").each(function(d){var e=$(this).data("settings");if("undefined"!=typeof e&&"undefined"!=typeof e.input){if(-1!=b.indexOf(+e.ChartInPageId))return;if(-1==a.indexOf(e.input.DataSourceId))return;7!=+e.type&&c++,setTimeout(function(){e.titlebar.showProgress(!0),$(this).charts(e.type,"refreshWithData",e,{refreshRelatedDatasources:!1})},7==+e.type?0:c*app.chartLoadDelay)}})},app.moderation.dashboadpage.selectValueOnChart=function(a,b){var c=a.chartInPageId;return-1==+a.Id?(app.chartCommons.userFilter.setFilter({id:a.Id,values:a.Values,variableType:a.VariableType,dimensionName:a.dimensionName,chartInPageId:a.chartInPageId,datasourceId:a.datasourceId}),app.moderation.dashboadpage.refreshRelatedDatasources(b,[+c]),void app.filterBox.refresh()):void $.ajax({type:"POST",url:app.urlPrefix+"Moderation/GlobalVariable/SetValueForUser",dataType:"json",contentType:"application/json;charset=utf-8",traditional:!0,data:JSON.stringify(a),success:function(a){a.result?(app.moderation.dashboadpage.refreshRelatedDatasources(a.relatedDatasource,[+c]),app.filterBox.refresh()):alert(a.Message)}})};var app=app||{};app.dashboardLayoutVersion=2;var dashboard={defuals:{maxCols:12},charts:[],pageInfo:{},pageId:-1,arrangePer:!1,minChartSize:{1:[500,250],2:[350,350],3:[300,200],4:[300,300],5:[500,300],6:[300,200],7:[350,50],8:[300,300],9:[300,300]},padding:10,maxCols:12,baseDimantion:{y:30},serialize:function(){dashboard.gs.serialize()},drillDownResize:function(a,b){},setInfo:function(a,b,c,d){this.arrangePer=d||!1,this.charts=a||[],this.pageInfo=b||{chartsOrder:[],layout:[],pageLayout:"30_30_30"},this.pageId=c||-1},disable:function(){dashboard.gs.disable(),dashboard.gs.disable_resize()},enable:function(){dashboard.gs.enable(),dashboard.gs.enable_resize()},saveSerialize:function(){dashboard.serializeData=dashboard.gs.serialize();var a=dashboard.serializeData.map(function(a){return{chartIdPageId:a.data.ChartInPageId,col:a.wgd.col,row:a.wgd.row,size_x:a.wgd.size_x,size_y:a.wgd.size_y}}),b={pageId:this.pageId,chartsPosition:a,media:dashboard.media,maxCol:dashboard.maxCols};try{"undefined"==typeof dashboard.pageInfo.layout&&(dashboard.pageInfo.layout=[]);var c=dashboard.pageInfo.layout.filter(function(a){return a.media==dashboard.media});c.length>0?c[0].chartsPosition=a:dashboard.pageInfo.layout.push({media:dashboard.media,chartsPosition:a,maxCol:dashboard.maxCols})}catch(d){}$.ajax({type:"POST",url:app.urlPrefix+"Charts/DashboardPage/SetChartsOrder",dataType:"json",contentType:"application/json;charset=utf-8",traditional:!0,data:JSON.stringify(b),success:function(a){}})},add:function(a,b,c,d,e){b=b>dashboard.maxCols?dashboard.maxCols:b,d=d>dashboard.maxCols?dashboard.maxCols:d,dashboard.gs.add_widget(a,b,c,d,e)},initGs:function(a){return dashboard.baseDimantion={x:$(".gridster").width()/dashboard.maxCols,y:50},dashboard.gs=$(".gridster>div ").gridster({widget_margins:[0,0],widget_base_dimensions:[dashboard.baseDimantion.x,dashboard.baseDimantion.y],max_cols:dashboard.maxCols,min_cols:dashboard.maxCols,resize:{enabled:!0,stop:function(a,b,c){dashboard.saveSerialize();var d=$(c).find(".chart-data").data("settings");d.isDashboardResize=!0,$(c).find(".chart-data").charts(d.type,"refresh",d),d.widgetSize.size_y=+$(c).attr("data-sizey"),d.widgetSize.size_x=+$(c).attr("data-sizex")}},serialize_params:function(a,b){return{data:a.find(".chart-data").data("settings"),wgd:b}},draggable:{handle:".header, .header b",cancel:".desc",stop:function(a,b){$(b.$helper).removeClass("player-revert"),dashboard.saveSerialize()}}}).data("gridster"),a||(dashboard.gs.disable(),dashboard.gs.disable_resize()),dashboard.gs},deleteAll:function(){$("#ID0").data("settings");dashboard.gs.remove_widget($("#ID0"))},deleteChartFromGs:function(a,b){var c=$(a).parents(".chart-widget");dashboard.gs.remove_widget(c),b&&b()},getPagePosition:function(){var a=dashboard.pageInfo.layout.filter(function(a){return a.media<=dashboard.media}).sort(function(a,b){return+b.media-+a.media});return 0==a.length&&(dashboard.maxCols=4==dashboard.media||3==dashboard.media?12:1,a=dashboard.pageInfo.layout.filter(function(a){return a.maxCol==dashboard.maxCols})),a},getChartPosition:function(a,b){var c=dashboard.minChartSize[+a]||[300,300],d={col:1,row:1e3,size_x:Math.floor(c[0]/dashboard.baseDimantion.x)+1,size_y:Math.floor(c[1]/dashboard.baseDimantion.y)+1},e=[];try{var f=dashboard.getPagePosition();e=f[0].chartsPosition.filter(function(a){return a.chartIdPageId==b})}catch(g){}return e[0]||d},sortCharts:function(){try{var a=dashboard.getPagePosition();this.charts.sort(function(b,c){try{var d=a[0].chartsPosition.filter(function(a){return a.chartIdPageId==b.pageId})[0],e=a[0].chartsPosition.filter(function(a){return a.chartIdPageId==c.pageId})[0];return d.row==e.row?d.col-e.col:d.row-e.row}catch(f){return-1e3}})}catch(b){Error(b)}},addTasks:[],drow:function(){dashboard.initGs(this.arrangePer),dashboard.sortCharts();var a=0;this.charts.forEach(function(b,c){7!=+b.type&&a++;var d=a,e=setTimeout(function(){dashboard.addChart(b,null,!1,d*app.chartLoadDelay)},50*c);dashboard.addTasks.push(e)})},resize:function(){var a=$(".chart-data").map(function(a,b){return $(b).data("settings")}).toArray();$(".gridster").remove(),$("#dashboard-chart-panel").html('<div class="gridster"><div></div></div>'),dashboard.initGs(this.arrangePer),a.forEach(function(a){dashboard.addChart(null,a,!0)})},addChart:function(a,b,c,d){performance.now();"undefined"==typeof d&&(d=0),b&&(a={id:b.chartId,pageId:b.ChartInPageId,title:b.input.title,type:b.type,permissions:b.permissions,lastRefresh:b.lastRefresh,desc:b.desc});var e={chartId:a.id,ChartInPageId:a.pageId},f="ID"+a.pageId,g=$("<div class='chart-widget cid"+a.pageId+"'></div>"),h=7!=a.type,i=7!=a.type,j=app.absoluteUrl+"sadaf/management/#/charts/edit/0/"+e.chartId,k="javascript:dashboard.deleteChart("+e.ChartInPageId+", "+e.chartId+", "+a.permissions.DeletePermission+")",l=_.isEmpty(a.desc)?"":"<p><br/><b>"+app.lang.translate("desc")+":</b> "+a.desc.replace(/(\r\n|\n|\r)/gm,"<br/>")+"</p>",m=dashboard.getChartTemplate(this.arrangePer,a.permissions.EditPermission,j,k,i,a.title,f,a.lastRefresh,l,h);g.append(m);var n=b;b||(n=JSON.parse(a.detail));var b=b||$.extend({permissions:a.permissions,parameters:e,chartId:e.chartId,editLink:j,removeLink:k,RemoveFromPage:this.arrangePer,ChartInPageId:a.pageId,input:{RefreshDatasource:a.RefreshDatasource},lastRefresh:a.lastRefresh,desc:a.desc,type:a.type},n);if(wgd=dashboard.getChartPosition(a.type,a.pageId),b.widgetSize=wgd,dashboard.add(g,wgd.size_x,wgd.size_y,wgd.col,wgd.row),g.find(".show-extra-info").on("click",function(){g.find(".ui.card .ui.dimmer").dimmer("show")}),g.find(".dimmer-info").on("click",function(){g.find(".ui.card .ui.dimmer").dimmer("hide")}),g.find(".export-excel").on("click",function(){var a=g.find(".chart-data").data("settings");app.chartCommons.setFilterParameter(a),$.ajax({type:"POST",url:app.urlPrefix+"Charts/BarChart/ExportToExcel",data:JSON.stringify({ChartId:b.chartId,ChartInPageId:b.ChartInPageId,TableInfo:n.TableInfo,IsPivot:1==+n.chartProp.info.aggregation,drillDown:a.parameters.drillDown,userControlFilter:a.parameters.userControlFilter,userVariable:a.parameters.userVariable,otherFilters:a.parameters.otherFilters,filterHierarchy:app.chartCommons.getFilterHierarchy(b.ChartInPageId)}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){window.location=app.urlPrefix+"Charts/BarChart/Download?name="+a.name}})}),g.find(".export-print").on("click",function(){app.print.printSingle(".cid"+a.pageId,a.title)}),g.find(".clone-chart").on("click",function(){app.post(app.urlPrefix+"Moderation/Charts/CloneChart",{Id:b.chartId,PageId:dashboard.pageId},function(a){if(a.result&&a.insertedId){var b=a.insertedId,c=app.urlPrefix+"api/dashboards/getSingleChartInfo?chartId="+b+"&chartInPageId="+a.chartInPageId;$.get(c,function(a){dashboard.charts.push(a),dashboard.addChart(a,null,!1),$("html, body").animate({scrollTop:$(document).height()-$(window).height()},1e3)})}})}),g.find(".chart-dimentions").on("click",function(){g.find(".chart-dimentions-content").transition("fade up"),g.find(".chart-dimentions").transition("fade")}),g.find(".show-chart-dimensions").on("click",function(){var a=g.find(".chart-dimentions-content");g.find(".chart-dimentions-content").transition("fade up"),g.find(".chart-dimentions").transition("fade"),""==a.html()&&(a.html('<div class="ui text active loader">در حال بارگذاری</div>'),$.ajax(app.urlPrefix+"api/chartdata/GetChart?Id="+b.chartId+"&ChartInPageId="+b.ChartInPageId).done(function(c){function d(a,b){return null!=a?"<ul class='sortable list-unstyled pointer' index='"+b+"'>"+a.map(function(a,b){return a.ShowFilter?'<li value="'+a.Uniquename+'">  '+a.Caption+'<i class="icon filter filter-member-dialog" style="float:left; margin-right:5px;"></i></li>':'<li value="'+a.Uniquename+'"> '+a.Caption+"</li>"}).join("")+"</ul>":""}function e(){function d(b,c){var d=b[c],e=[];a.find("ul[index="+c+"] li").each(function(a,b){var c=$(this).attr("value"),f=$.grep(d,function(a){return a.Uniquename==c})[0];f.Members=$(this).data("members"),e.push(f)}),b[c]=e}d(c,"Hierarchies"),d(c,"Where"),d(c,"SeriesLevel");var e=function(a){b.parameters={filterHierarchy:app.chartCommons.getFilterHierarchy(b.ChartInPageId),chartId:b.chartId,ChartInPageId:b.ChartInPageId},$("#ID"+b.ChartInPageId).charts(b.type,"refreshWithData",b,{refreshRelatedDatasources:!1})};e(c)}a.data("data",c);var f=null,g=null,h=null;f=d(c.Hierarchies,"Hierarchies"),g=d(c.Where,"Where"),h=d(c.SeriesLevel,"SeriesLevel");var i='<table class="ui single line unstackable table chart-design" xstyle="display:none" xstyle="position:absolute;margin-bottom:0px; background-color:#fff;display:none; border-bottom:1px solid silver">                                           <thead><tr class="">                                             <th style="'+(""==h?"display:none":"")+'"><span data-trans-key="شاخص‌ها (ستون‌های عددی)" > </span> </th>                                             <th style="'+(""==f?"display:none":"")+'"><span data-trans-key="ابعاد (ستون‌های رشته‌ای)" > </span> </th>                                             <th style="'+(""==g?"display:none":"")+'"><span data-trans-key="شرط" > </span></th>                                         </tr></thead>                                         <tr>                                             <td  style="'+(""==h?"display:none":"")+'"id="div-x" class="myc">'+h+'</td>                                             <td  style="'+(""==f?"display:none":"")+'"id="div-y" class="myc">'+f+'</td>                                             <td  style="'+(""==g?"display:none":"")+'"id="div-where" class="myc">'+g+"</td>                                         </tr>                                     </table>";a.html(i),a.find(".filter-member-dialog").on("click",function(){function a(a,b){app.helper.filterMemberDialog(a,b,function(a){d.data("members",a),e()})}var d=$(this).parent(),f=$(this).parent().attr("value"),g=c[$(this).closest("ul").attr("index")],h=($.grep(g,function(a,b){return a.Uniquename==f})[0],$(this).parent().data("members")),i=app.urlPrefix+"api/chartdata/GetMemberOfFilterHierarchy?Uniquename="+f+"&Id="+b.chartId+"&ChartInPageId="+b.ChartInPageId;
"undefined"==typeof h?$.ajax(i).done(function(b){$(this).parent().data("members",b),a(b,i)}):a(h,i)}),a.find(".sortable").sortable({start:function(a,b){b.placeholder.addClass("filter-placeholder"),b.placeholder.height(b.item.height()),b.placeholder.width(b.item.width()),b.placeholder.parent().width(b.item.width()),b.placeholder.parent().parent().width(b.item.width())},stop:function(a,b){e()}}),app.lang.setLang({selector:a.selector})}))}),g.find(".dropdown").dropdown(),c)g.find(".bar-chart").data("settings",b),g.find(".chart-data").charts(a.type,"refresh",b,!0);else{var o=setTimeout(function(){g.find(".chart-data").charts(a.type,b)},7==+a.type?0:d);dashboard.addTasks.push(o)}app.lang.setLang({selector:".chart-widget.cid"+a.pageId}),this.showEmptyMessageIfNeed()},showEmptyMessageIfNeed:function(){0==dashboard.charts.length?$("#chart-empty-message").hasClass("hidden")&&$("#chart-empty-message").transition("scale in"):$("#chart-empty-message").hasClass("hidden")||$("#chart-empty-message").transition("scale out")},deleteChart:function(a,b,c){if(a)c?$("#deleteChart .checkbox").show():$("#deleteChart .checkbox").hide(),$("#deleteChart").data("cId",a),$("#deleteChart").data("chartId",b),$("#deleteChart").modal("show");else{var a=$("#deleteChart").data("cId"),b=$("#deleteChart").data("chartId"),d=app.urlPrefix+"charts/dashboardPage/removeChartFromPage";$("#deleteChart .action-btn").addClass("loading"),$.post(d,{ChartInPageId:a,pageId:dashboard.pageId},function(b){if(0==b)return void alert("شما مجوز پاک کردن این نمودار را ندارید");for(var c,d=0;d<dashboard.charts.length;d++)if(dashboard.charts[d].pageId==a){c=dashboard.charts[d].pageId,dashboard.charts.splice(d,1)}dashboard.deleteChartFromGs("#ID"+c,function(){$(this).remove(),dashboard.showEmptyMessageIfNeed()}),$("#deleteChart").modal("hide"),$("#deleteChart .action-btn").removeClass("loading")});var e=$("#delete-from-dash").prop("checked");e&&$.post(app.urlPrefix+"Moderation/Charts/DeleteCharts",{Ids:["ChartId-"+b]},function(a){})}},getChartTemplate:function(a,b,c,d,e,f,g,h,i,j){return'<div class="ui card">  <div class="content" style="">    <div class="header '+(a?"move":"")+'">            <div class="menu-bar chart-setting-icon">                <div class="ui dropdown rightxfloated" >                        <i class="setting icon chart-setting-icon"></i>                        <div class=" menu transition hidden" tabindex="-1">                          '+(b?' <a class="item"  href="'+c+'"><span data-trans-key="ویرایش" > </span> <i class="edit icon"></i></a>':"")+"                          "+(b?' <a class="item clone-chart"><span data-trans-key="تکرار" > </span> <i class="copy icon"></i></a>':"")+"                          "+(a?'<a class="item" href="'+d+'"><span data-trans-key="حذف نمودار از صفحه" > </span> <i class="trash outline icon"></i></a>':"")+"                          "+(j?'<a class="item export-excel"><span data-trans-key="خروجی اکسل" > </span> <i class="file excel outline icon"></i></a>':"")+'                           <a class="item export-print"><span data-trans-key="print" > </span> <i class="print icon"></i></a>                        </div>                </div>                <div class="rightxfloated ">                    '+(e?'<i class="info icon chart-setting-icon show-extra-info pointer"></i>':"")+"                    "+(e?'<i class="filter icon  chart-setting-icon show-chart-dimensions pointer"></i>':"")+"                </div>            </div>        "+f+'    </div>    <div class="description chart-data bar-chart" id="'+g+'">      <div class="ui active inverted dimmer ">        <div class="ui text loader tiny">در حال بارگذاری</div>      </div>    </div>  </div>  <div class="progress-overall"></div>  <div class="chart-dimentions"></div>  <div class="chart-dimentions-content"></div>  <div class="ui dimmer overflow-auto" style="padding:10px;border-radius: 4px !important;"><div class="content"><div class="center"><div class="dimmer-info"><b>'+app.lang.translate("lastUpdate")+':</b> <span class="last-refresh">'+app.chartCommons.lastRefreshDateFormat(h)+"</span>"+i+"</div></div></div></div></div>"},setLastRefresh:function(a,b){var c=$(".cid"+a+" .last-refresh");c.html(app.chartCommons.lastRefreshDateFormat(b))}},ngApp=angular.module("sadaf");ngApp.directive("onFinishRender",["$timeout",function(a){return{restrict:"A",link:function(b,c,d){b.$last===!0&&a(function(){b.$emit(d.onFinishRender)})}}}]),ngApp.directive("sglclick",["$parse",function(a){return{restrict:"A",link:function(b,c,d){var e=a(d.sglclick),f=200,g=0,h=null;c.on("click",function(a){g++,1===g?h=setTimeout(function(){b.$apply(function(){e(b,{$event:a})}),g=0},f):(clearTimeout(h),g=0)})}}}]),ngApp.controller("dashboardPageCtrl",["$scope","$http","$sce","$routeParams","$location","$timeout","drawer","$translate","$rootScope",function(a,b,c,d,e,f,g,h,i){function j(){$(".ui.modal#edit-menus").modal("show")}function k(){$(".ui.modal#edit-menus").modal("hide")}function l(){var b=$(window).width()<=723,c=$(".side-menu");b||a.isFullscreen?($(".toc-toggle").show(),c.removeClass("my-fix no-padd no-margin"),c.addClass("sidebar right  menu fixed vertical"),$(".main-container").addClass("mobile")):($(".toc-toggle").hide(),c.addClass("my-fix no-padd no-margin"),c.removeClass("sidebar right  menu fixed vertical"),$(".main-container").removeClass("mobile")),b?$(".full-screen-toggle").hide():$(".full-screen-toggle").show()}a.mainMenuType=2,h.use(0==+$("#lang").val()?"fa":"en"),a.persian=persian,a.isPersian=0==+$("#lang").val(),g.init(),i.$on("permission-change",function(b,c){a.hasEditPermission=c;var d="visible"==$(".dashboard-edit-panel").css("visibility");c&&!d&&$(".dashboard-edit-panel").transition("fade left in"),!c&&d&&$(".dashboard-edit-panel").transition("fade right out")}),a.$on("ngRepeatFinished",function(){$(".side-menu .ui.dropdown").dropdown()});const m=+localStorage.getItem("defaultDashboard");app.mobileMode||b.get(app.urlPrefix+"menu/MenuCategories/1").then(function(b){a.menuCategories=b.data;var c=b.data.defaultId;a.reorderPermission=b.data.reorderPermission;var f=d.id||m||c;d.id||e.path("/dashboard/"+f),a.menuCategories&&_.each(a.menuCategories.data,function(a){_.each(a.menus,function(b){b.menu.Id==f&&(a.open=!0,a.active=!0,b.active=!0)})})},function(){}),a.sortableOptions={disabled:!a.editMode,stop:function(c,d){f(function(){a.isDrag=!1;var c=$(d.item).parents(".menu-category").data("id"),e=$(d.item).data("id"),f=$(d.item).parents(".menu-category").find(".dashboard-menu").map(function(){return+$(this).data("id")}).toArray();b.post(app.urlPrefix+"menu/ChangeMenuOrder",{list:f,menuId:e,parentCategoryId:c}).then(null,function(a){alert(a.data.title+" - "+a.data.desc)})},0)},connectWith:".connected-sortable"},a.sortableCatOptions={disabled:!a.editMode,stop:function(a,c){f(function(){var a=$(".menu-category").map(function(){return+$(this).data("id")}).toArray();b.post(app.urlPrefix+"menu/ChangeMenuCategoryOrder",{list:a})},0)}},a.clearActive=function(){a.menuCategories&&_.each(a.menuCategories.data,function(a){a.open=!1,a.active=!1,_.each(a.menus,function(a){a.active=!1})})},a.closeAll=function(b){var c=b.open;a.menuCategories&&!a.editMode&&_.each(a.menuCategories.data,function(a){a.open=!1,a.active=!1}),b.open=!c,b.active=!c},a.editMode=!1,a.toggleEdit=function(){a.editMode=!a.editMode,$("div[ui-sortable=sortableOptions]").sortable("option","disabled",!a.editMode),$("div[ui-sortable=sortableCatOptions]").sortable("option","disabled",!a.editMode),a.editMode?$(".icon.sort").transition("set looping").transition("pulse"):$(".icon.sort").transition("remove looping")},a.isFullscreen=$("#isFullscreen").val(),a.fullscreenToggle=function(){a.isFullscreen=!a.isFullscreen,l(),dashboard.resize(),b.get(app.urlPrefix+"api/users/toogleFullscreen?isFullScreen="+a.isFullscreen)},a.$on("$locationChangeStart",function(b,c,d){if(/\/dashboard\/\d+/.test(e.path())){var f=+e.path().replace(/\/dashboard\/(\d+)/gi,"$1");a.clearActive(),a.menuCategories&&a.menuCategories.data&&_.each(a.menuCategories.data,function(a){_.each(a.menus,function(b){b.menu.Id==f&&(a.active=!0,a.open=!0,b.active=!0)})})}}),a.modal={body:c.trustAsHtml(""),btnClass:"btn-primary",btnText:"ذخیره",inProgress:!1},a.hideModal=function(){k()},a.addMenuToCategory=function(d){a.modal={btnClass:"btn-primary green",btnText:app.lang.translate("ساختن"),inProgress:!1,label:app.lang.translate("نام منو را وارد کنید"),ok:function(){a.modal.inProgress=!0,a.modal.btnText=app.lang.translate("در حال ساختن...");var f=app.urlPrefix+"Charts/DashboardPage/addMenu";b.post(f,{menuName:a.modal.val,menuCategory:d.category.Id,mainMenu:1,menulink:""}).then(function(b){a.modal.btnText=app.lang.translate("ساختن"),$("#dashboard-page-modal").modal("hide"),d.menus=d.menus||[],d.menus.push(b.data),e.path("/dashboard/"+b.data.menu.Id),k()},function(b){a.modal.btnText=app.lang.translate("ساختن"),a.modal.inProgress=!1,a.modal.error=b.data,"undefined"==typeof a.modal.error.title&&(a.modal.error=c.trustAsHtml(b.data))})}},j()},a.editCategory=function(d){a.modal={btnClass:"btn-primary green",btnText:app.lang.translate("تغییر"),inProgress:!1,label:app.lang.translate("نام جدید را وارد کنید"),val:d.category.Name,ok:function(){a.modal.inProgress=!0,a.modal.btnText=app.lang.translate("در حال تغییر...");var e=app.urlPrefix+"Charts/DashboardPage/editMenu";b.post(e,{menuName:a.modal.val,menuCategory:d.category.Id,mainMenu:1}).then(function(b){a.modal.btnText=app.lang.translate("تغییر"),$("#dashboard-page-modal").modal("hide"),d.category.Name=b.data.Name,k()},function(b){a.modal.btnText=app.lang.translate("تغییر"),a.modal.inProgress=!1,a.modal.error=b.data,"undefined"==typeof a.modal.error.title&&(a.modal.error=c.trustAsHtml(b.data))})}},j()},a.deleteCategory=function(d,e){a.modal={btnClass:"btn-danger red",btnText:app.lang.translate("حذف"),inProgress:!1,body:c.trustAsHtml("با انتخاب گزینه حذف، گروه <b>"+d.category.Name+"</b> حذف می‌شود. آیا اطمینان دارید؟"),ok:function(){a.modal.inProgress=!0,a.modal.btnText=app.lang.translate("در حال حذف...");var f=app.urlPrefix+"Charts/DashboardPage/deleteMenu";b.post(f,{menuCategory:d.category.Id}).then(function(b){a.modal.btnText=app.lang.translate("حذف"),$("#dashboard-page-modal").modal("hide"),a.menuCategories.data.splice(e,1),k()},function(b){a.modal.btnText=app.lang.translate("حذف"),a.modal.inProgress=!1,a.modal.error=b.data,"undefined"==typeof a.modal.error.title&&(a.modal.error=c.trustAsHtml(b.data))})}},j()},a.editMenu=function(d,e){a.modal={btnClass:"btn-primary green",btnText:app.lang.translate("تغییر"),inProgress:!1,val:d.menu.Name,label:app.lang.translate("نام جدید را وارد کنید"),ok:function(){a.modal.inProgress=!0,a.modal.btnText=app.lang.translate("در حال تغییر...");var e=app.urlPrefix+"Charts/DashboardPage/editMenu";b.post(e,{menuName:a.modal.val,menuId:d.menu.Id}).then(function(b){a.modal.btnText=app.lang.translate("تغییر"),$("#dashboard-page-modal").modal("hide"),d.menu.Name=b.data.Name,k()},function(b){a.modal.btnText=app.lang.translate("تغییر"),a.modal.inProgress=!1,a.modal.error=b.data,"undefined"==typeof a.modal.error.title&&(a.modal.error=c.trustAsHtml(b.data))})}},j()},a.deleteMenu=function(d,e,f){a.modal={btnClass:"btn-danger red",btnText:app.lang.translate("حذف"),inProgress:!1,body:c.trustAsHtml("با انتخاب گزینه حذف، منوی <b>"+d.menu.Name+"</b> حذف می‌شود. آیا اطمینان دارید؟"),ok:function(){a.modal.btnText=app.lang.translate("در حال حذف...");var g=app.urlPrefix+"Charts/DashboardPage/deleteMenu";b.post(g,{menuId:d.menu.Id}).then(function(b){a.modal.btnText=app.lang.translate("حذف"),$("#dashboard-page-modal").modal("hide"),e.menus.splice(f,1),k()},function(b){a.modal.btnText=app.lang.translate("حذف"),a.modal.inProgress=!1,a.modal.error=b.data,"undefined"==typeof a.modal.error.title&&(a.modal.error=c.trustAsHtml(b.data))})}},j()},a.duplicateMenu=function(a,c){b.post(app.urlPrefix+"menu/DuplicateMenu",{Id:a.menu.Id}).then(function(a){c.menus=c.menus||[],c.menus.push(a.data.item),k()},function(a){alert(a.data)})},a.addCat=function(){a.modal={btnClass:"btn-primary green",btnText:app.lang.translate("ساختن"),inProgress:!1,label:app.lang.translate("نام منو را وارد کنید"),ok:function(){a.modal.inProgress=!0,a.modal.btnText=app.lang.translate("در حال ساختن...");var d=app.urlPrefix+"Charts/DashboardPage/addMenu";b.post(d,{menuName:a.modal.val,mainMenu:1}).then(function(b){a.modal.btnText=app.lang.translate("ساختن"),a.modal.inProgress=!1,$("#dashboard-page-modal").modal("hide"),a.menuCategories=a.menuCategories||{},a.menuCategories.data=a.menuCategories.data||[];var c={category:{Id:b.data.menu.Id,MainMenuId:b.data.menu.MainMenuId,Name:b.data.menu.Name,Type:b.data.menu.Type},hasAddPer:!0,hasDeletePer:!0,hasEditPer:!0,open:!0,menus:[]};a.menuCategories.data.push(c),k()},function(b){a.modal.btnText=app.lang.translate("ساختن"),a.modal.inProgress=!1,a.modal.error=b.data,"undefined"==typeof a.modal.error.title&&(a.modal.error=c.trustAsHtml(b.data))})}},j()},a.closeSidebar=function(){$(".ui.sidebar").sidebar("setting","transition","overlay").sidebar("setting","mobileTransition","overlay").sidebar("hide")},a.cancelRequests=function(){for($(".chart-data").each(function(){var a=$(this).data("ajaxRequest");a&&a.abort()});dashboard.addTasks.length;){var a=dashboard.addTasks.pop();clearTimeout(a)}},$(".toc-toggle").on("click",function(){$(".ui.sidebar").sidebar("setting","transition","overlay").sidebar("setting","mobileTransition","overlay").sidebar("toggle")}),$(window).resize(function(){l()}),l()}]),ngApp.controller("dashboardPageBodyCtrl",["$scope","$http","$sce","$routeParams","navbar","$rootScope","$timeout","drawer","$q","$rootScope",function(a,b,c,d,e,f,g,h,i,f){function j(a){return a?(dashboard.showEmptyMessageIfNeed(),void dashboard.drow()):void dashboard.resize()}function k(a,b){function c(){$(window).width()<768?(dashboard.media=1,dashboard.maxCols=1):$(window).width()<992?(dashboard.media=2,dashboard.maxCols=1):$(window).width()<1200?(dashboard.media=3,dashboard.maxCols=12):(dashboard.media=4,dashboard.maxCols=12);try{var a=dashboard.getPagePosition();dashboard.maxCols=a[0].maxCol}catch(b){Error(b)}$("#dashboard-col").val(dashboard.maxCols),$("#device-selector .icon").removeClass("active"),$($("#device-selector .icon").get(4-dashboard.media)).addClass("active")}function d(a,b){if(dashboard.pageInfo&&dashboard.pageInfo.layout){var c=dashboard.pageInfo.layout.filter(function(b){return+b.media==+a});c.length>0&&(c[0].maxCol=b)}}app.chartCommons.userFilter.setUserControlFilters(a.userControlFilters),app.chartCommons.drillDown.clearAll(),dashboard.setInfo(a.charts,a.pageInfo,a.pageId,b),app.dashboardLayoutVersion=2;app.urlPrefix+"charts/dashboardpage/setchartsorder";c(),app.moderation.dashboadpage.isRelated=!1,j(!0),app.lestenWindowResize(function(){0!=$("#dashboard-chart-panel").length&&(c(),j(!1))}),$(".dashboard-page-header .add-chart-btn").on("click",function(){app.packages.view.selectPackage(app.packages.controller.scopes.CHARTS,function(a,b){var a=a||[];a.forEach(function(a){var c=app.urlPrefix+"api/dashboards/addChartToPage";b.setLoading(),$.get(c,{chartId:a,pageId:dashboard.pageId},function(a){dashboard.charts.push(a),dashboard.addChart(a,null,!1),b.hide()})})},!0)}),$("#dashboard-col").on("change",function(){dashboard.maxCols=+$(this).val()||dashboard.maxCols,dashboard.resize(dashboard.arrangePer),dashboard.saveSerialize(),d(dashboard.media,dashboard.maxCols)});$("#device-selector .icon").on("click",function(a){var b=$(this);if($("#device-selector .icon").removeClass("active"),b.addClass("active"),dashboard.media=4-b.index(),dashboard.pageInfo&&dashboard.pageInfo.layout){var c=dashboard.getPagePosition();dashboard.maxCols=c.length>0&&c[0].maxCol?c[0].maxCol:4==dashboard.media||3==dashboard.media?12:1,$("#dashboard-col").val(dashboard.maxCols),dashboard.resize(dashboard.arrangePer),dashboard.saveSerialize()}});var e=null,f=$('<div class="copy-handler"></div>').css("position","fixed").css("display","none");$("body").append(f),$("#device-selector .icon").mousedown(function(a){var b=a.currentTarget;e=$(b).attr("id"),f.show(),setTimeout(function(){e=null},3e3)}),$("#device-selector .icon").mouseup(function(a){var b=a.currentTarget;if(target=$(b).attr("id"),null!=e&&e!=target){var c=function(a){return"laptop"==a?4:"tablet"==a?3:"smartphone-land"==a?2:1},d=dashboard.pageInfo.layout.indexOf(dashboard.pageInfo.layout.filter(function(a){return a.media==+c(target)})[0]),f=$.extend({},dashboard.pageInfo.layout.filter(function(a){return a.media==+c(e)})[0]);f.media=+c(target),dashboard.pageInfo.layout.splice(d,1,f),dashboard.saveSerialize(),e=null,alert("cope done!")}}),$(".freeze-menu").on("hide.bs.collapse",function(){$(".freeze-menu").addClass("hide-aff")}).on("show.bs.collapse",function(){$(".freeze-menu").removeClass("hide-aff")}),$(".freeze-menu").on("affixed.bs.affix",function(){$(".freeze-menu.affix").css("width",$("#content_segment").width()+"px")})}h.close(),a.model="param: "+d.id;var l=app.urlPrefix+"api/dashboards/get/"+d.id;dashboard.canceler&&dashboard.canceler.resolve("http call aborted"),dashboard.canceler=i.defer(),a.progress=!0,b({method:"GET",url:l,timeout:dashboard.canceler.promise}).then(function(b){a.progress=!1,f.$broadcast("app-filterbox-refresh");var c=$(window).width()<=723,d=!c&&b.data.arrangePer;k(b.data,d);var g=e.getOption();g||(g={onDesignClick:function(){$(".dashboard-page-header").collapse("toggle")},onFullScreenClick:function(){var a=e.getOption();a.isFullscreen=!a.isFullscreen,a.isFullscreen?($(".side-menu").hide(),$(".contain-body").removeClass("col-md-10"),$(".contain-body").addClass("col-md-12")):($(".side-menu").show(),$(".contain-body").removeClass("col-md-12"),$(".contain-body").addClass("col-md-10"),a.sliding&&(a.sliding=!a.sliding,app.autoPlay("stop"))),"undefined"!=typeof j&&j()},onSlideShowClick:function(){var a=e.getOption();a.sliding=!a.sliding,a.sliding?app.autoPlay("start",10):app.autoPlay("stop")},onPrintClick:function(){app.print.printPage()}}),g.canDesign=d,e.setOption(g),f.$broadcast("permission-change",d)},function(){a.progress=!1,$("#no-page-message").transition("in scale")})}]),ngApp.config(["$routeProvider","$locationProvider",function(a,b){a.when("/dashboard/:id",{templateUrl:app.urlPrefix+"dist/partial/dashboardPage/su.dashboardBody.html",controller:"dashboardPageBodyCtrl"})}]),jQuery.fn.createModal=function(a){$el=$(this),0==$el.length&&($el=$("#content_segmentModal")),$el.find("#"+a.id).remove();var b="undefined"!=typeof a.okId?' id="'+a.okId+'" ':"",c="undefined"!=typeof a.okFun?' onclick="'+a.okFun+'" ':"";"undefined"!=typeof a.okFunObj&&(c="");var d=' <div class="modal '+("undefined"==typeof a.Fade||a.Fade?"fade":"")+'" id="'+a.id+'" tabindex="-1" role="dialog" aria-labelledby="'+a.id+'Label" aria-hidden="true">          <div class="modal-dialog">                                                                                                       <div class="modal-content">                                                                                                      <div class="modal-header">                                                                                                       <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>                                 <h4 class="modal-title">'+a.title+'</h4>                                                                       </div>                                                                                                                       <div class="modal-body">                                                                                                         '+a.body+'                                                                                                     </div>                                                                                                                       <div class="modal-footer">                                                                                                      '+("undefined"!=typeof a.cancelText?' <button type="button" class="btn btn-default" data-dismiss="modal" >'+a.cancelText+"</button>":"")+"                        "+("undefined"!=typeof a.okText?'<button type="button" class="btn '+a.okClass+' okbtn" data-dismiss="modal" '+c+b+">"+a.okText+"</button>":"")+"</div>                                                                                                                   </div>                                                                                                                       <!-- /.modal-content -->                                                                                                 </div>                                                                                                                       <!-- /.modal-dialog -->                                                                                                  </div>                                                                                                                       <!-- /.modal -->                                                                                                                     ",e=$(d);e.appendTo($el),"undefined"!=typeof a.okFunObj&&e.find(".okbtn").on("click",function(){a.okFunObj()}),"undefined"==typeof a.id||"undefined"!=typeof a.onKey&&!a.onKey||($("#"+a.id).on("keypress",function(b){13===b.keyCode&&(b.preventDefault(),$("#"+a.id+" .okbtn").click())}),$("#"+a.id).on("shown.bs.modal",function(){$("#"+a.id+" input").first().focus()}))},app=app||{},app.globalVariableHelper={},app.globalVariableHelper.updateGlobalVariables=function(a,b,c){return},app.globalVariableHelper.createModalRow=function(a){var b=$(app.globalVariableHelper.addModalRow);return a&&b.find(".default-value").val(a),b.find(".btn-plus").on("click",function(){var a=app.globalVariableHelper.createModalRow(this);$(this).parents(".form-group").after(a)}),b.find(".btn-minus").on("click",function(){$(this).parents(".form-group").remove()}),b},app.globalVariableHelper.AddGlobalVariables=function(a){var b=$(app.globalVariableHelper.addModal);$("#gb-modal").remove(),b.find(".row-container").append(app.globalVariableHelper.createModalRow()),app.contentSegmentModal.append(b),$("#gb-modal .btn-primary").on("click",function(){var b={Name:$("#gb-modal input.name").val(),Scope:$("#gb-modal select.scope").val(),DefaultValue:$("#gb-modal input.default-value").map(function(){return $(this).val()}).toArray()};$.ajax({type:"POST",url:app.urlPrefix+"Moderation/GlobalVariable/Add",dataType:"json",contentType:"application/json;charset=utf-8",traditional:!0,data:JSON.stringify(b),success:function(b){b.result?a(b):alert(b.Message)}})}),$("#gb-modal").modal("show")},app.globalVariableHelper.EditGlobalVariables=function(a,b){var c=$(app.globalVariableHelper.addModal);$("#gb-modal").remove(),c.find("input.name").val(a.Name),c.find("select.scope").val(a.Scope),c.find(".btn-primary").text("تغییر");var d=JSON.parse(a.DefaultValue||'[""]');d&&0!=d.length||(d=[""]),d.forEach(function(a){var b=app.globalVariableHelper.createModalRow(a);c.find(".row-container").append(b)}),app.contentSegmentModal.append(c),$("#gb-modal .btn-primary").on("click",function(){var c={Id:a.Id,Name:$("#gb-modal input.name").val(),Scope:$("#gb-modal select.scope").val(),DefaultValue:$("#gb-modal input.default-value").map(function(){return $(this).val()}).toArray()};$.ajax({type:"POST",url:app.urlPrefix+"Moderation/GlobalVariable/Add",dataType:"json",contentType:"application/json;charset=utf-8",traditional:!0,data:JSON.stringify(c),success:function(a){a.result?b(a):alert(a.Message)}})}),$("#gb-modal").modal("show")},app.globalVariableHelper.addModal='<div class="modal fade" id="gb-modal" tabindex="-1" role="dialog" aria-labelledby="gb-modal-label" aria-hidden="true                style="font-size: 14px; text-align: justify;">                <div class="modal-dialog">                <div class="modal-content">                    <div class="modal-header">                        <button type="button" class="close" data-dismiss="modal">                            <span aria-hidden="true">&times;</span><span class="sr-only">بستن</span></button>                        <h4 class="modal-title" id="gb-modal-label">ساخت متغیر سراسری</h4>                    </div>                <div class="modal-body">                    <p>                        این متغیر برای تمامی کاربران قابل اعمال است.                                        .نام متغیر نباید شامل علامت باشد و باید ترکیبی از حروف و اعداد باشد                    </p>                    <div class="form-horizontal">                        <div class="form-group">                            <label class="col-sm-4" style="font-weight: bold;">نام متغیر: </label>                            <div class="col-sm-8">                                <input type="text" class="form-control name" placeholder="نام متغیر" />                            </div>                        </div>                        <div class="form-group">                            <label class="col-sm-4" style="font-weight: bold;">حوزه اعتبار: </label>                            <div class="col-sm-8">                                <select class="form-control scope" >                                <option value="0">تمام صفحات</option>                                <option value="1" selected="selected">صفحه جاری</option>                                </select>                            </div>                        </div>                        <div class="row-container"></div>                    </div>                                          </div>                                                                                                                                                   <div class="modal-footer">                    <button type="button" class="btn btn-default" data-dismiss="modal">بستن</button>                    <button type="button" class="btn btn-primary" data-dismiss="modal">ساختن</button>                </div>            </div>        </div>    </div>',app.globalVariableHelper.addModalRow='            <div class="form-group modal-row">                <label class="col-sm-4" style="font-weight: bold;">مقدار پیش‌فرض: </label>                <div class="col-sm-5">                    <input type="text" class="form-control default-value" placeholder="مقدار پیش‌فرض" />                </div>                <div class="col-md-3">                    <div class="btn-group btn-group-justified">                        <a type="button" class="btn btn-default btn-plus"><span class="glyphicon glyphicon-plus"></span></a>                        <a type="button" class="btn btn-default btn-minus"><span class="glyphicon glyphicon-minus"></span></a>                    </div>                </div>            </div>';var app=app||{};app.packages={},app.packages.controller={scopes:{CHARTS:1,DATASOURCES:2},add:function(a,b,c,d,e){$.ajax({url:app.urlPrefix+"Moderation/Package/Create",data:JSON.stringify({name:a,scope:b,parentId:d,permissions:c,isEdit:isEdit}),type:"POST",dataType:"json",contentType:"application/json",traditional:!0,success:function(a){a.result?e&&e():alert(a.message)}})},getRoles:function(a){app.post(app.urlPrefix+"Moderation/Package/GetRoles",null,a)}},app.packages.view={createPackage:function(a,b,c){var d=$(app.packages.view.createModal);app.contentSegmentModal.append(d),d.modal("show"),d.on("shown.bs.modal",function(){d.find("#name").focus()}),d.find("#name").keyup(function(a){13==a.keyCode&&d.find(".btn-primary").click()}),d.find(".btn-primary").addClass("disabled"),app.packages.controller.getRoles(function(e){var f=e.roles||[];d.find(".btn-primary").removeClass("disabled");var g="<h3>نقش‌ها</h3><form id='packages-permission' style='height: 180px; overflow-y: scroll;'> <table class='table table-hover '>";f.forEach(function(a){g+="<tr>           <td>                                                                                                                                     <label style='font-weight: normal; font-size: 1em;'>                                                                                     <input type='checkbox' name='Roles' value='"+a.Id+"' >                                                                          "+a.RoleName+"                                                                                                              </label>                                                                                                                         </td>                                                                                                                                <td>                                                                                                                                     <select class='form-control' name='ChartActions'>                                                                                        <option value='1-"+a.Id+"' >مشاهده</option>                                        <option value='2-"+a.Id+"'>مشاهده و ویرایش</option>                               <option value='4-"+a.Id+"' >مشاهده، ویرایش و حذف</option>                   </select>                                                                                                                        </td>                                                                                                                            </tr>"}),g+="</form>",d.find("#progress").hide(),d.find(".modal-body").append(g),app.packages.view.showPermissionChoise("#package-modal .modal-body"),d.find(".btn-primary").on("click",function(){var e=d.find("#packages-permission").serializeArray();e&&(e=e.filter(function(a){return"ChartActions"==a.name}).map(function(a){return a.value})),$(this).button("loading");var f=d.find("#name").val();app.post(app.urlPrefix+"Moderation/Package/Create",{name:f,scope:a,parentId:b,permissions:e},function(a){d.find(".btn-primary").button("reset"),d.modal("hide"),c(a)})})})},editPackage:function(a,b){var c=$(app.packages.view.createModal);app.contentSegmentModal.append(c),c.modal("show"),c.on("shown.bs.modal",function(){c.find("#name").focus();var a=c.find("#name").val().length;c.find("#name").get(0).setSelectionRange(a,a)}),c.find("#name").keyup(function(a){13==a.keyCode&&c.find(".btn-primary").click()}),c.find(".btn-primary").addClass("disabled"),c.find(".btn-primary").html("ویرایش"),app.post(app.urlPrefix+"Moderation/Package/GetInfo",{id:a},function(d){var e=d.roles||[];c.find(".btn-primary").removeClass("disabled");var f="<h3>نقش‌ها</h3><form id='packages-permission' style='height: 180px; overflow-y: scroll;'> <table class='table table-hover '>";if(e.forEach(function(a){f+="<tr>           <td>                                                                                                                                     <label style='font-weight: normal; font-size: 1em;'>                                                                                     <input type='checkbox' name='Roles' value='"+a.Id+"' >                                                                          "+a.RoleName+"                                                                                                              </label>                                                                                                                         </td>                                                                                                                                <td>                                                                                                                                     <select class='form-control' name='ChartActions'>                                                                                        <option value='1-"+a.Id+"' >مشاهده</option>                                        <option value='2-"+a.Id+"'>مشاهده و ویرایش</option>                               <option value='4-"+a.Id+"' >مشاهده، ویرایش و حذف</option>                   </select>                                                                                                                        </td>                                                                                                                            </tr>";
}),f+="</form>",c.find("#progress").hide(),c.find(".modal-body").append(f),app.packages.view.showPermissionChoise("#package-modal .modal-body"),d.info&&d.info.actions){var g=d.info.actions||[];g.forEach(function(a){c.find("option[value="+a.Action+"-"+a.RoleId+"]").attr("selected","selected").parents("tr").find("input").click()})}c.find("#name").val(d.info.Name),c.find(".btn-primary").on("click",function(){var d=c.find("#packages-permission").serializeArray();d&&(d=d.filter(function(a){return"ChartActions"==a.name}).map(function(a){return a.value}));var e=c.find("#name").val();c.find(".btn-primary").data("loading-text","در حال تغییر"),c.find(".btn-primary").button("loading"),app.post(app.urlPrefix+"Moderation/Package/Edit",{id:a,name:e,permissions:d},function(a){c.find(".btn-primary").button("reset"),c.modal("hide"),b(a)})})})},showPermissionChoise:function(a){function b(a,b){a?b.find("select").css("visibility","visible").attr("disabled",null):b.find("select").css("visibility","hidden").attr("disabled","")}$(a+" tr input").each(function(){b($(this).prop("checked"),$(this).closest("tr"))}),$(a+" tr input").change(function(){b(this.checked,$(this).closest("tr"))}),$(a+" table thead input").change(function(){var a=this.checked;$(this).closest("table").find("tr input").each(function(){$(this).prop("checked",a),b(this.checked,$(this).closest("tr"))})})},selectPackage:function(a,b,c){var d=$(app.packages.view.selectPackageModal);$("body #package-modal").remove(),$("body").append(d),d.modal("show"),app.post(app.urlPrefix+"Moderation/Package/GetPackages",{scope:a,withContent:c},function(a){d.find("#progress").hide(),d.find(".content").html(a.packages),d.find(".content>ul").css("direction","ltr"),d.find(".content>ul").selectable({filter:".select-package",selecting:function(a,b){!c&&d.find(".ui-selected, .ui-selecting").length>1&&$(b.selecting).removeClass("ui-selecting")}}),d.find(".content>ul").treeview({animated:"fast",collapsed:!0,toggle:function(){}}),d.find(".btn-primary").on("click",function(){var a=d.find(".ui-selected"),c=a.map(function(a){return $(this).data("id")}).toArray();b&&b(c,{hide:function(){d.modal("hide")},setLoading:function(){d.find(".btn-primary").addClass("loading")}})})})},createModal:'<div class="modal fade" id="package-modal" tabindex="-1" role="dialog" aria-labelledby="gb-modal-label" aria-hidden="true                style="font-size: 14px; text-align: justify;">                <div class="modal-dialog">                <div class="modal-content">                    <div class="modal-header">                        <button type="button" class="close" data-dismiss="modal">                            <span aria-hidden="true">&times;</span><span class="sr-only">بستن</span></button>                        <h4 class="modal-title" id="gb-modal-label">ساخت پوشه جدید</h4>                    </div>                <div class="modal-body" >                    <div class="form-group">                        <label for="chartTitleFarsi" class="col-md-4 control-label">نام پوشه:</label>                        <div class="col-md-8" style="margin-bottom: 30px;"><input id="name" class="form-control"placeholder="نام پوشه" /></div>                    </div>                    <div id="progress" >                        <img style="width: 1.3em" src="'+app.urlPrefix+'Images/progress.gif" />                        در حال بارگذاری . . .                    </div>                </div>                <div class="modal-footer">                    <button type="button" class="btn btn-default" data-dismiss="modal">انصراف</button>                    <button type="button" class="btn btn-primary" data-loading-text="در حال ساختن...">ساختن</button>                </div>            </div>        </div>    </div>',selectPackageModal:'<div class="ui modal small" id="package-modal">    <i class="close icon"></i>    <div class="header">فیلتر کردن مقادیر</div>    <div class="content" style="height: 180px; overflow-y: scroll;">        <div class="ui active inverted dimmer"><div class="ui text loader">در حال بارگذاری</div></div></div>    <div class="actions">        <button type="button" class="ui button deny black" >انصراف</button>        <button type="button" class="ui button green btn-primary" >انتخاب</button>    </div></div>'},$.fn.tableSortable=function(a){var b=$(this);b.find("th").addClass("pointer").on("click",function(c,d){var d=$(this).index()+1,e=b.find("tbody tr");a&&(e=e.not(a));var f=$(this).data("isdesc");"undefined"==typeof f&&(f=!0),$(this).data("isdesc",!f),e.sort(function(a,b){var c=depersian($(a).find("td:nth-child("+d+")").text()),e=depersian($(b).find("td:nth-child("+d+")").text());return f?/^[0-9.]+$/.test(c)?d3.descending(+c,+e):d3.descending(c,e):/^[0-9.]+$/.test(c)?d3.ascending(+c,+e):d3.ascending(c,e)}),e.remove(),b.append(e)})},$.fn.tableBindSearchbox=function(a,b){var c=$(this),a=a instanceof $?a:$(a);a.keyup(function(){var a=$(this).val(),d=c.find("tbody tr");b&&(d=d.not(b)),d.each(function(){-1==$(this).text().toLocaleLowerCase().indexOf(a.toLocaleLowerCase())?$(this).hide():$(this).show()})})},jQuery.fn.progressbar=function(a,b){function c(){var a=d3.interpolate(0,h);return function(b){return j.endAngle(a(b))()}}if("stop"==a)return void d3.select($(this).get(0)).select(".sadaf-circular-timeout").remove();var d=+a||25,e=d/5,f=2*d,g=2*d,h=2*Math.PI,i=+b||1e4,j=d3.svg.arc().startAngle(0).innerRadius(d-e).outerRadius(d);d3.select($(this).get(0)).select(".sadaf-circular-timeout").remove();var k=d3.select($(this).get(0)).append("svg").attr("width",f).attr("height",g).attr("class","sadaf-circular-timeout").append("g").attr("transform","translate("+f/2+","+g/2+")"),l=k.append("g").attr("class","progress-meter");l.append("path").attr("class","background").style("fill","#eee").style("opacity","0.2").attr("d",j.endAngle(h));var m=l.append("path").style("fill","#ccc").attr("class","foreground");m.attr("d",j.endAngle(0*h)),m.transition().duration(i).attrTween("d",c)},$.extend($.datepicker,{_checkOffset:function(a,b,c){var d=a.dpDiv.outerWidth(),e=a.dpDiv.outerHeight(),f=a.input?a.input.outerWidth():0,g=a.input?a.input.outerHeight():0,h=document.documentElement.clientWidth+(c?0:$(document).scrollLeft()),i=document.documentElement.clientHeight+(c?0:$(document).scrollTop());return b.left-=this._get(a,"isRTL")?d-f:0,b.left-=c&&b.left==a.input.offset().left?$(document).scrollLeft():0,b.top-=c&&b.top==a.input.offset().top+g?$(document).scrollTop():0,b.left-=Math.min(b.left,b.left+d>h&&h>d?Math.abs(b.left+d-h):0),b.top-=Math.min(b.top,b.top+e>i&&i>e?Math.abs(e+g):0),b.top<50&&(b.top=55),b}});var app=app||{};app.escapeBraket=function(a){return a.replace("[","\\\\[").replace("]","\\\\]")};
//# sourceMappingURL=dashboard-app-theme2.js.map