

<div flex layout="column">
    <md-toolbar xstyle="background-color:white; color:#666" class="md-primary md-hue-3" md-theme="t1">
        <div class="md-toolbar-tools ">

            <span flex></span>

            <md-input-container md-no-float class="md-block" style="margin-top:30px">
                <input ng-model="search" placeholder="{{'جستجو' | translate}}">
            </md-input-container>

            <md-button class="md-icon-button cssFade" ng-show="isSelected()" ng-click="delete($event)">
                <span class="material-icons">delete</span>
                <md-tooltip>{{'remove' | translate}}</md-tooltip>
            </md-button>
            <md-button class="md-icon-button" ng-click="new($event)">
                <span class="material-icons">add_circle</span>
                <md-tooltip>{{'new_role' | translate}}</md-tooltip>
            </md-button>
        </div>
    </md-toolbar>

    <div flex layout="column">
        <md-content flex>

            <table class="sadaf-table" ng-show="search.length">
                <tr>
                    <th>
                        <md-checkbox class="no-margin" ng-model="selectAllCheckbox" ng-change="selectAll()" aria-label="{{ 'select_all' | translate}}"></md-checkbox>
                    </th>
                    <th>#</th>
                    <th>{{'name' | translate}}</th>
                </tr>

                <tr ng-repeat="row in data" ng-class="{active : row.select}" ng-click="row.select = !row.select;" ng-dblclick="goto(row, $event)">
                    <td width="20" style="height:48px;">
                        <md-checkbox class="no-margin" ng-model="row.select" ng-click="$event.stopPropagation();" aria-label="{{ 'choose' | translate}}"></md-checkbox>
                    </td>
                    <td width="20">{{utils.persian($index+1)}}</td>

                    <td><span class="pointer" ng-click="goto(row, $event); $event.stopPropagation();">{{row.name}}</span></td>
                </tr>
            </table>

            <div layout="row" layout-sm="column" layout-align="space-around" ng-show="progress" layout-margin>
                <md-progress-circular md-mode="indeterminate" md-diameter="30"></md-progress-circular>
            </div>
            <p ng-bind-html="error" ng-show="error" class="danger " layout-padding></p>
            <div ng-hide="(data && data.length) || progress || error" class="md-caption" style="padding:16px; text-align:center">داده‌ای برای نمایش وجود ندارد</div>

            <div class="sadaf-tree" style="margin: 0 40px;" ng-hide="search.length">
                <h3 class="header ui">
                    نقش‌ها
                </h3>
                <div class="ui divider"></div>

                <div class="tree-element ul" style="list-style:none">
                    <div ng-repeat="data in root.nodes track by $index" class="tree-element li" ng-include="'xtree.html'"></div>
                </div>

            </div>
            <script type="text/ng-template" id="xtree.html">
                <collapse class="block" ng-model="data" hide-icon="{{(!data.nodes || !data.nodes.length ) &&  ( !data.contents || !data.contents.length) }}">
                    <collapse-header class="block hide-item-parent">
                        <span style="margin:0" href="{{app.hashUrlPrefix}}#/roles/edit/{{data.id}}">{{data.name}} </span>&nbsp;&nbsp;&nbsp;&nbsp;
                        <a class="ui gray icon mini right floated  hide-item" href="{{app.hashUrlPrefix}}#/roles/edit/{{data.id}}">
                            <i class="ui icon mini edit" title="{{'ویرایش' | translate}}"></i>
                        </a>
                        <a class="ui gray icon mini right floated hide-item" href="{{app.hashUrlPrefix + '#/roles/edit/0/' + data.id}}">
                            <i class="ui icon mini add" title="{{'add' | translate}}"></i>
                        </a>
                        <a class="ui gray icon mini right floated hide-item" ng-click="deleteOne(data)">
                            <i class="ui icon mini trash" title="{{'delete' | translate}}"></i>
                        </a>
                    </collapse-header>
                    <collapse-body class="block">
                        <div class="tree-element ul" style="list-style:none">
                            <div ng-repeat="data in data.nodes track by $index" class="tree-element li" ng-include="'xtree.html'"></div>
                        </div>
                    </collapse-body>
                </collapse>
            </script>

        </md-content>
    </div>


    <div class="ui modal role-delete-modal">
        <div class="header">حذف نقش</div>
        <div class="content">موارد درخواستی برای همیشه حذف شوند؟</div>
        <div class="actions">
            <div ng-click="" class="ui button deny">لغو</div>
            <div ng-click="deleteRole(false)" ng-class="{loading:deleteProgress && deleteType !='with-child'}" class="ui button red">حذف</div>
            <div ng-click="deleteRole(true)" ng-class="{loading:deleteProgress&& deleteType =='with-child'}" class="ui button black">حذف به همراه فرزندان</div>
        </div>
    </div>

</div>
