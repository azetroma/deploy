<menu-item class="">
    <menu-header style="position:relative" class="pointer">
        <div data-toggle="" href="#alerts">{{ 'هشدارها' | translate }}</div>
    </menu-header>
    <menu-body id="alerts" class="prop-section   form-horizontal">
        <div layout="row" layout-align="start center">
            <p ng-hide="model[config.name].alerts && model[config.name].alerts.length>0" style="font-size: 0.8em;">{{ 'هنوز هشداری تعریف نشده است' | translate }}</p>
            <span flex></span>

            <md-button class="md-icon-button" ng-click="newAlert()" title="{{'add' | translate}}">
                <span class="material-icons">add</span>
            </md-button>
        </div>

        <fieldset ng-repeat="alert in model[config.name].alerts">
            <legend>
                <span layout="row" layout-align="start center">
                    <span>{{'alert' | translate}} {{$index+1}}</span>

                    <md-button class="md-icon-button" ng-click="model[config.name].alerts.splice($index, 1)">
                        <span class="material-icons">delete</span>
                    </md-button>
                </span>


            </legend>

            <div class="alert-form-group">
                <div class="form-row" layout="row" layout-align="start center">
                    <label class="col-sm-4">{{ 'نوع هشدار' | translate }}</label>
                    <span class="form-divider" flex></span><div class="col-sm-8">
                        <select class="form-control" ng-change="" ng-model="alert.type"ng-options="color.name as  color.value for color in [
                                    {name:'sms', value: 'پیام کوتاه'  }, 
                                    {name:'email', value: 'پست الکترونیک'  }, 
                                    ]">
                            <!--<option value="sms">{{ 'پیام کوتاه' | translate }}</option>
                            <option value="email">{{ 'پست الکترونیک' | translate }}</option>
                            <option value="webservice">{{ 'اجرای وب سرویس' | translate }}</option>
                            <option value="command">{{ 'اجرای دستور' | translate }}</option>-->
                        </select>
                    </div>
                </div>
                <div class="form-row" layout="row" layout-align="start center" ng-show="alert.type=='sms' || alert.type=='email' ">
                    <label class="col-sm-4">{{ 'عنوان پیام ارسالی' | translate }}</label>
                    <span class="form-divider" flex></span><div class="col-sm-8">
                        <input type="text" class="form-control" data-trans-key='عنوان' data-trans-attr='placeholder' ng-model="alert.title" />
                    </div>
                </div>
                <div class="form-row" layout="row" layout-align="start center">
                    <div class="col-sm-12">
                        <label class="left-margin">
                            <input type="checkbox" ng-model="alert.showDatasourceTime" /> {{ 'نمایش زمان به‌روز رسانی منبع داده' | translate }}
                        </label>
                    </div>
                </div>
            </div>

            <!--<md-button class="md-raised" style="font-size:12px;" xng-hide="alert.rules && alert.rules.length>0" ng-click="alert.rules.push({})">
                {{'new rule' | translate}}
            </md-button>-->

            <div ng-repeat="item in alert.rules" ng-init="alert.rules = alert.rules || [{}]">
                <div class="ui tiny secondary pointing menu">
                    <div class="active item">{{ 'شرط‌' | translate }}</div>
                    <div class="right menu">
                        <!--<div class="ui item">
                            <div class="ui tiny pointer" ng-click="alert.rules.push({})"><i class="ui icon plus"></i></div>
                            <div class="ui tiny pointer" ng-click="alert.rules.splice($index, 1)" ng-show="alert.rules.length > 1"><i class="ui icon minus"></i></div>
                        </div>-->
                    </div>
                </div>
                <sadaf-indicator ng-model="item" series="model.series" hide-then="true"></sadaf-indicator>
            </div>

            <!--<fieldset ng-repeat="item in alert.rules">
                <legend>{{ 'شرط‌' | translate }}</legend>
                <sadaf-indicator ng-model="item" series="model.series" hide-then="true"></sadaf-indicator>
            </fieldset>-->

            <div class="ui tiny dividing header">{{ 'مخاطبین' | translate }}</div>
            <div>
                <sadaf-contact-list ng-model="alert.contactList"></sadaf-contact-list>
            </div>

            <div class="" style="margin:16px 0;">
                <b class="ui tiny header">{{ 'نقش‌ها' | translate }}</b>
                <select-roles ng-model="alert.roles" class="ui tiny form"></select-roles>
                <small class="grey">در صورت انتخاب نقش، به تمام کاربران آن نقش هشدار فرستاده می‌شود</small>
            </div>
            
            <!--<fieldset>
                <legend>{{ 'مخاطبین' | translate }}</legend>
                <div>
                    <sadaf-contact-list ng-model="alert.contactList"></sadaf-contact-list>
                </div>
            </fieldset>-->

            <div class="form-row" layout="row" layout-align="start center" ng-show="alert.type=='command'">
                <label class="col-sm-4 control-label">دستور: </label>
                <span class="form-divider" flex></span><div class="col-sm-8">
                    <input type="text" class="form-control" data-trans-key='دستور' data-trans-attr='placeholder' ng-model="alert.command">
                </div>
            </div>

            <div class="form-row" layout="row" layout-align="start center" ng-show="alert.type=='webservice'">
                <label class="col-sm-4 control-label">آدرس: </label>
                <span class="form-divider" flex></span><div class="col-sm-8">
                    <input type="text" class="form-control" data-trans-key='آدرس' data-trans-attr='placeholder' ng-model="alert.webservice">
                </div>
            </div>

            <datasource-schedule style="margin-top:10px;display:block;" ng-model="alert.schedule"> </datasource-schedule>

            <div class="form-row" layout="row" layout-align="start center" ng-show="alert.type=='sms' || alert.type=='email' ">
                <div class="alert-section" style="margin-top:10px">{{ 'فرمت نمایش' | translate }}</div>
                <span class="form-divider" flex></span>
                <div class="col-sm-12 ltr code">
                    <input type="text" class="form-control" data-trans-key='فرمت نمایش' data-trans-attr='placeholder' ng-model="alert.format" />
                </div>
            </div>

            <div style="text-align:left">
                <span> <code class="inline ltr">@{k}</code>: برچسب</span>
                <span> <code class="inline ltr">@{m}</code>: شاخص</span>
                <span> <code class="inline ltr">@{n}</code>: مقدار</span>
            </div>

            <div class="form-row" layout="row" layout-align="start center">
                <div layout-wrap>
                    <span>{{ 'انتخاب شاخص‌ها' | translate }}</span>
                    <label ng-repeat="s in model.series" class="left-margin">
                        <input type="checkbox"
                               ng-click="toggleSelectedSeries(alert, s)"
                               ng-checked="alert.selectedSeries.indexOf(s)!=-1" /> {{s}}
                    </label>
                </div>


            </div>
        </fieldset>
    </menu-body>
</menu-item>
