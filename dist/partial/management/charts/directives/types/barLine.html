<menu-container open-menu-name="openMenuName">

    <menu-item>
        <menu-header  data-toggle="" >{{ 'تنظیمات کلی' | translate }}</menu-header>
        <menu-body  class="prop-section  form-horizontal" >
            <div>
                <input type="hidden" ng-model="ngModel.bar.info.canExportXlsx" value="true" />

                <general-settings ng-model="ngModel.bar.info"></general-settings>

                <div class="form-row" layout="row" layout-align="start center">
                    <div class="col-sm-offset-4 col-sm-8">
                        <div class="checkbox">
                            <label class="">
                                <input type="checkbox" ng-model="ngModel.bar.info.horizontalLines" ng-change="refreshChart('refresh')" /> {{ 'خطوط افقی در نمودار' | translate }}
                            </label>
                        </div>
                    </div>
                </div>

                <div class="form-row" layout="row" layout-align="start center">
                    <div class="col-sm-offset-4 col-sm-8">
                        <div class="checkbox">
                            <label class="">
                                <input type="checkbox" ng-model="ngModel.bar.info.sortMeasures" ng-change="refreshChart('refreshWithData')" /> {{ 'مرتب کردن شاخص‌ها در حالت تجمیع' | translate }}
                            </label>
                        </div>
                    </div>
                </div>

                <div class="form-row" layout="row" layout-align="start center">
                    <div class="col-sm-offset-4 col-sm-8">
                        <div class="checkbox">
                            <label class="">
                                <input type="checkbox" ng-model="ngModel.bar.info.showSortBox" ng-change="refreshChart('refresh')" /> {{ 'نمایش گزینه مرتب کردن' | translate }}
                            </label>
                        </div>
                    </div> 
                </div>

                <div class="form-row" layout="row" layout-align="start center">
                    <label class="col-sm-4">{{ 'قالب اعداد محور عمودی' | translate }}</label>
                    <span class="form-divider" flex></span><div class="col-sm-8">
                        <select class="selectpicker-x-x form-control" ng-model="ngModel.bar.info.formatString" ng-change="refreshChart('refresh')">
                            <option value="A">{{ 'عادی' | translate }}</option>
                            <option value="%">{{ 'درصد' | translate }}</option>
                            <option value=",.1%">#,#.0%</option>
                            <option value=",.2%">#,#.00%</option>
                            <option value=",.0f">#,#</option>
                            <option value=",.1f">#,#.0</option>
                            <option value=",.2f" selected="selected">#,#.00</option>
                        </select>
                    </div>
                </div>

                <div class="form-row" layout="row" layout-align="start center">
                    <label>{{ 'فونت محور افقی' | translate }}</label>
                    <span class="form-divider" flex></span>
                    <text-editor prop="ngModel.bar.info.font"></text-editor>
                </div>


                <div class="form-row" layout="row" layout-align="start center">
                    <label class="col-sm-4">{{ 'مکان نمایش راهنما' | translate }}</label>
                    <span class="form-divider" flex></span><div class="col-sm-8">
                    <legend-position ng-model="ngModel.bar.info.legendPosition" change="refreshChart('refresh')"></legend-position>
                    </div>
                </div>

                <div class="form-row" layout="row" layout-align="start center">
                    <label>{{ 'فونت برچسب راهنما' | translate }}</label>
                    <span class="form-divider" flex></span>
                    <text-editor prop="ngModel.bar.info.legendFont"></text-editor>
                </div>


                <div class="form-row" layout="row" layout-align="start center">
                    <label class="col-sm-4">{{ 'حداکثر کاراکتر برچسب‌ها' | translate }}</label>
                    <span class="form-divider" flex></span><div class="col-sm-8">
                        <input type="text" class="form-control" placeholder="{{ 'حداکثر کاراکتر برچسب‌ها' | translate }}" ng-model="ngModel.bar.info.xAxisLen"
                               ng-change="refreshChart('refresh')" ng-model-options="{ updateOn: 'blur' }" />
                    </div>
                </div>


                <div class="form-row" layout="row" layout-align="start center">
                    <label class="col-sm-4">{{ 'حد بالای محور عمودی' | translate }}</label>
                    <span class="form-divider" flex></span><div class="col-sm-8">
                        <input type="text" class="form-control" placeholder="{{ 'حد بالای محور عمودی' | translate }}" ng-model="ngModel.bar.info.yAxisMax"
                               ng-change="refreshChart('refresh')" ng-model-options="{ updateOn: 'blur' }" />
                    </div>
                </div>

                <div class="form-row" layout="row" layout-align="start center">
                    <label class="col-sm-4">{{ 'حد پایین محور عمودی' | translate }}</label>
                    <span class="form-divider" flex></span><div class="col-sm-8">
                        <input type="text" class="form-control" placeholder="{{ 'حد پایین محور عمودی' | translate }}" ng-model="ngModel.bar.info.yAxisMin"
                               ng-model-options="{ updateOn: 'blur' }" ng-change="refreshChart('refresh')" />
                    </div>
                </div>

                <div class="form-row" layout="row" layout-align="start center">
                    <label class="col-sm-4">{{ 'پشته‌کردن میله‌ها' | translate }}</label>
                    <span class="form-divider" flex></span><div class="col-sm-8">
                        <select class=" selectpicker-x-x form-control" ng-model="ngModel.bar.info.stackedBar" ng-change="refreshChart('refreshWithData')">
                            <option value="1" selected="selected">{{ 'بدون پشته' | translate }}</option>
                            <option value="2">{{ 'پشته کردن تمام میله‌ها' | translate }}</option>
                            <option value="3">{{ 'پشته کردن درصدی تمام میله‌ها' | translate }}</option>
                        </select>
                    </div>
                </div>

                <div class="form-row" layout="row" layout-align="start center">
                    <label class="col-sm-4">{{ 'پشته‌کردن خط‌ها' | translate }}</label>
                    <span class="form-divider" flex></span><div class="col-sm-8">
                        <select class=" selectpicker-x-x form-control" ng-model="ngModel.bar.info.stackedLine" ng-change="refreshChart('refreshWithData')">
                            <option value="1" selected="selected">{{ 'بدون پشته' | translate }}</option>
                            <option value="2">{{ 'پشته کردن تمام خط‌ها' | translate }}</option>
                            <option value="3">{{ 'پشته کردن درصدی تمام خط‌ها' | translate }}</option>
                        </select>
                    </div>
                </div>

                <div class="form-row" layout="row" layout-align="start center">
                    <label class="col-sm-4">{{ 'حالت نمایش راهنما' | translate }}</label>
                    <span class="form-divider" flex></span><div class="col-sm-8">
                        <select class=" selectpicker-x-x form-control" ng-model="ngModel.bar.info.tooltip" ng-change="refreshChart('refresh')">
                            <option value="1" selected="selected">{{ 'مجزا' | translate }}</option>
                            <option value="2">{{ 'تمام شاخص‌های پیدا' | translate }}</option>
                            <option value="3">{{ 'تمام شاخص‌ها' | translate }}</option>
                        </select>
                    </div>
                </div>

     


                <div class="form-row" layout="column" layout-align="start top">
                    <label class="control-label">{{ 'قالب تیتر راهنما' | translate }}</label>
                    <textarea flex class="form-control"
                              ng-change="refreshChart('refresh')"
                              ng-model-options="{ updateOn: 'blur' }"
                              ng-model="ngModel.bar.info.tooltipHeader"
                              style="direction:ltr; text-align:left; font-family:monospace; resize:vertical"></textarea>
                    <p class="help-block">
                        متغیرهای قابل استفاده:
                        <code class="inline">
                            set.key
                        </code> ,<code class="inline">
                            set.sum
                        </code> ,<code class="inline">
                            set.avg
                        </code>,<code class="inline">
                            set.points
                        </code>
                    </p>
                </div>
                <div class="form-row" layout="column">
                    <label class="control-label">{{ 'قالب نمایش راهنما' | translate }}</label>
                    <textarea class="form-control"
                              flex
                              ng-change="refreshChart('refresh')" ng-model-options="{ updateOn: 'blur' }"
                              ng-model="ngModel.bar.info.tooltipFormat" style="direction:ltr; text-align:left; font-family:monospace;resize:vertical"></textarea>
                    <p class="help-block">
                        متغیرهای قابل استفاده:
                        <code class="inline">
                            point.data
                        </code> ,<code class="inline">
                            point.label
                        </code> ,<code class="inline">
                            point.color
                        </code>
                        <div>
                            تگ‌های مجاز:
                        </div>
                        <div class="ltr text-left">

                            <code>&lt;b&gt;</code>, <code>&lt;strong&gt;</code>, <code>&lt;i&gt;</code>, <code>&lt;em&gt;</code>, <code>&lt;br/&gt;</code>, <code>&lt;span&gt;</code>
                        </div>
                    </p>
                </div>


               
            </div>
        </menu-body>
    </menu-item>

    <menu-item  ng-show="ngModel.series && ngModel.series.length>0" name="series" > 
        <menu-header  data-toggle="" >{{ 'مشخصات شاخص‌ها' | translate }}</menu-header>
        <menu-body class="prop-section form-horizontal   ">
            <div>
                <div class="form-row" layout="row" layout-align="start center">
                    <label class="col-sm-4">{{ 'شاخص' | translate }}</label>
                    <span class="form-divider" flex></span><div class="col-sm-8">
                        <select id="series-selector" class="selectpicker-x-x form-control" ng-model="ngModel.selectedSeries"
                                ng-options="i as i for i in ['{All}'].concat(ngModel.series) track by i"></select>

                    </div>
                </div> 

                <div class="form-row" layout="row" layout-align="start center">
                    <label class="col-sm-4">{{ 'نام شاخص' | translate }}</label>
                    <span class="form-divider" flex></span><div class="col-sm-8">
                        <input type="text" class="form-control" placeholder="{{ 'نام شاخص' | translate }}"
                               ng-change="refreshChart('refresh'); changeAllSeries('name')"
                               ng-model-options="{ updateOn: 'blur' }"
                               ng-model="ngModel.bar.series[ngModel.selectedSeries].name" />
                    </div>
                </div>




                <div class="form-row" layout="row" layout-align="start center">
                    <div class="col-sm-offset-4 col-sm-8">
                        <div class="checkbox">
                            <label class="">
                                <input type="checkbox" ng-change="refreshChart('refresh'); changeAllSeries('hidden')" ng-model="ngModel.bar.series[ngModel.selectedSeries].hidden" /> {{ 'مخفی کردن' | translate }}
                            </label>
                        </div>
                    </div>
                </div>
                <div class="form-row" layout="row" layout-align="start center" ng-show="ngModel.bar.series[ngModel.selectedSeries].seriesType!='bar'">
                    <div class="col-sm-offset-4 col-sm-8">
                        <div class="checkbox">
                            <label class="">
                                <input type="checkbox" ng-model="ngModel.bar.series[ngModel.selectedSeries].dontShowZeroValue" ng-change="refreshChart('refresh');changeAllSeries('dontShowZeroValue')" /> {{ 'عدم نمایش مقادیر صفر' | translate }}
                            </label>
                        </div>
                    </div>
                </div>


                <div class="form-row" layout="row" layout-align="start center">
                    <div class="col-sm-offset-4 col-sm-8">
                        <div class="checkbox">
                            <label class="">
                                <input type="checkbox" ng-change="refreshChart('refresh'); changeAllSeries('cumulative')" ng-model="ngModel.bar.series[ngModel.selectedSeries].cumulative" /> {{ 'نمایش تجمعی مقادیر' | translate }}
                            </label>
                        </div>
                    </div>
                </div>

                <div class="form-row" layout="row" layout-align="start center" ng-show="ngModel.bar.series[ngModel.selectedSeries].cumulative">
                    <label class="col-sm-4">{{ 'aggregation_formula' | translate }}</label>
                    <span class="form-divider" flex></span><div class="col-sm-8">
                        <select class="selectpicker-x-x form-control" ng-model="ngModel.bar.series[ngModel.selectedSeries].cumulative_formula" ng-change="refreshChart('refresh')">
                            <option value="sum">SUM</option>
                            <option value="avg">AVG</option>
                            <option value="var">VAR</option>
                        </select>
                    </div>

                </div>



                <div class="form-row" layout="row" layout-align="start center">
                    <div class="col-sm-offset-4 col-sm-8">
                        <div class="checkbox">
                            <label class="">
                                <input type="checkbox" ng-change="refreshChart('refresh'); changeAllSeries('showValues')" ng-model="ngModel.bar.series[ngModel.selectedSeries].showValues" /> {{ 'نمایش مقادیر روی نمودار' | translate }}
                            </label>
                        </div>
                    </div>
                </div>

                <div id="showValueColorSeg" ng-show="ngModel.bar.series[ngModel.selectedSeries].showValues">

                    <div class="form-row" layout="row" layout-align="start center">
                        <label>{{ 'فونت' | translate }}</label>
                        <span class="form-divider" flex></span>
                        <text-editor prop="ngModel.bar.series[ngModel.selectedSeries].font"></text-editor>
                    </div>

                </div>




                <number-format ng-model="ngModel.bar.series[ngModel.selectedSeries]"></number-format>




                <div class="form-row" layout="row" layout-align="start center">
                    <label class="col-sm-4">{{ 'نوع نمودار' | translate }}</label>
                    <span class="form-divider" flex></span><div class="col-sm-8">
                        <div class="sadaf-group">
                            <label class="sadaf-group-item"
                                   ng-class="ngModel.bar.series[ngModel.selectedSeries].seriesType==i.t?'active':''"
                                   ng-repeat="i in [{t:'bar', n:'ستونی'}, {t:'line', n:'خطی'}]"
                                   ng-click="ngModel.bar.series[ngModel.selectedSeries].seriesType=i.t;refreshChart('refresh'); changeAllSeries('seriesType')">

                               <span class="sadaf-group-item-text">{{i.n}}</span> 
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="form-row" layout="row" layout-align="start center">
                    <label class="col-sm-4">{{ 'رنگ' | translate }}</label>
                    <span class="form-divider" flex></span>
                    <div class="col-sm-8">
                        <div md-color-picker ng-model="ngModel.bar.series[ngModel.selectedSeries].seriesColor" md-color-default-tab="'genericPalette'" on-change="refreshChart('refresh')"></div>
                    </div>
                </div>

                <div ng-show="ngModel.bar.series[ngModel.selectedSeries].seriesType=='line'">

                    <div class="form-row" layout="row" layout-align="start center">
                        <label class="col-sm-4">{{ 'شفافی' | translate }}</label>
                        <span class="form-divider" flex></span><div class="col-sm-8">
                            <input type="number" class="form-control" placeholder="{{ 'شفافی' | translate }}"
                                   ng-change="refreshChart('refresh'); changeAllSeries('areaOpacity')"
                                   ng-model-options="{ updateOn: 'blur' }"
                                   ng-model="ngModel.bar.series[ngModel.selectedSeries].areaOpacity" />
                        </div>
                    </div>


                    <div class="form-row" layout="row" layout-align="start center">
                        <label class="col-sm-4">{{ 'شکل نمودار' | translate }}</label>
                        <span class="form-divider" flex></span><div class="col-sm-8">
                            <div class="sadaf-group">
                                <label class="sadaf-group-item"
                                       ng-class="ngModel.bar.series[ngModel.selectedSeries].lineType==i.t?'active':''"
                                       ng-repeat="i in [{t:'line', n:'line'}, {t:'line-area', n:'area'}, {t:'line-dot', n:'line-dot'}, {t:'dot', n:'dot'}, {t:'line-dot-area', n:'line-dot-area'}]"
                                       ng-click="ngModel.bar.series[ngModel.selectedSeries].lineType=i.t;refreshChart('refresh'); changeAllSeries('lineType')">
                                    <span class="chart {{i.n}}"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="form-row" layout="row" layout-align="start center">
                        <label class="col-sm-4">{{ 'حالت خط' | translate }}</label>
                        <span class="form-divider" flex></span><div class="col-sm-8">
                            <div class="sadaf-group">
                                <label class="sadaf-group-item"
                                       ng-class="ngModel.bar.series[ngModel.selectedSeries].lineStyle==i.t?'active':''"
                                       ng-repeat="i in [{t:'linear', n:'lineStyle-angle'}, {t:'cardinal', n:'lineStyle-curve'}, {t:'step', n:'lineStyle-square'}]"
                                       ng-click="ngModel.bar.series[ngModel.selectedSeries].lineStyle=i.t;refreshChart('refresh'); changeAllSeries('lineStyle')">
                                    <span class="chart {{i.n}}"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="form-row" layout="row" layout-align="start center">
                        <label class="col-sm-4">{{ 'قطر خط' | translate }}</label>
                        <span class="form-divider" flex></span><div class="col-sm-8">
                            <div class="sadaf-group">
                                <label class="sadaf-group-item"
                                       ng-class="ngModel.bar.series[ngModel.selectedSeries].lineWeight==i.t?'active':''"
                                       ng-repeat="i in [{t:'2', n:'lineWeight-2'},
                                                        {t:'3', n:'lineWeight-3'},
                                                        {t:'4', n:'lineWeight-4'},
                                                        {t:'5', n:'lineWeight-5'},
                                                        {t:'6', n:'lineWeight-6'}]"
                                       ng-click="ngModel.bar.series[ngModel.selectedSeries].lineWeight=i.t;refreshChart('refresh'); changeAllSeries('lineWeight')">
                                    <span class="chart {{i.n}}"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="form-row" layout="row" layout-align="start center">
                        <label class="col-sm-4">{{ 'شکل خط' | translate }}</label>
                        <span class="form-divider" flex></span><div class="col-sm-8">
                            <div class="sadaf-group">
                                <label class="sadaf-group-item"
                                       ng-class="ngModel.bar.series[ngModel.selectedSeries].lineFace==i.t?'active':''"
                                       ng-repeat="i in [{t:'5,0', n:'lineDashes-solid'},
                                                        {t:'6,6', n:'lineDashes-Dash'},
                                                        {t:'2,2', n:'lineDashes-dot'}]"
                                       ng-click="ngModel.bar.series[ngModel.selectedSeries].lineFace=i.t;refreshChart('refresh'); changeAllSeries('lineFace')">
                                    <span class="chart {{i.n}}"></span>
                                </label>
                            </div>
                        </div>
                    </div>

                </div>

                <top-measure dims="dimensions" ng-model="ngModel.bar.series[ngModel.selectedSeries].top" ng-change="refreshChart('refreshWithData');"></top-measure>

            </div>

        </menu-body>
    </menu-item>

    <alert prop="ngModel" config="{name:'bar'}"></alert>

    <table-indicator dimensions="dimensions" measures="measures" prop="ngModel" config="{name:'bar', show:[1]}"></table-indicator>

    <global-variable dimensions="dimensions" measures="measures" prop="ngModel"></global-variable>

    <dim-meas-where model="openMenuName" ng-if="!isOlap" dimensions="dimensions" measures="measures" where="where" datasource="datasource"></dim-meas-where>

    <filter-except related-datasource-list="relatedDatasourceList" filter-exception="filterException" datasource="datasource"></filter-except>

    <calculate-fields calculated-fields="calculatedFields"></calculate-fields>

</menu-container>
